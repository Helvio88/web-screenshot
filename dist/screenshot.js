#!/usr/bin/env node
var Kn=Object.create;var er=Object.defineProperty;var Yn=Object.getOwnPropertyDescriptor;var Zn=Object.getOwnPropertyNames;var es=Object.getPrototypeOf,ts=Object.prototype.hasOwnProperty;var E=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var rs=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Zn(t))!ts.call(e,n)&&n!==r&&er(e,n,{get:()=>t[n],enumerable:!(i=Yn(t,n))||i.enumerable});return e};var Ce=(e,t,r)=>(r=e!=null?Kn(es(e)):{},rs(t||!e||!e.__esModule?er(r,"default",{value:e,enumerable:!0}):r,e));var pe=E(Ye=>{var $e=class extends Error{constructor(t,r,i){super(i),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.code=r,this.exitCode=t,this.nestedError=void 0}},Ke=class extends $e{constructor(t){super(1,"commander.invalidArgument",t),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name}};Ye.CommanderError=$e;Ye.InvalidArgumentError=Ke});var Se=E(et=>{var{InvalidArgumentError:is}=pe(),Ze=class{constructor(t,r){switch(this.description=r||"",this.variadic=!1,this.parseArg=void 0,this.defaultValue=void 0,this.defaultValueDescription=void 0,this.argChoices=void 0,t[0]){case"<":this.required=!0,this._name=t.slice(1,-1);break;case"[":this.required=!1,this._name=t.slice(1,-1);break;default:this.required=!0,this._name=t;break}this._name.length>3&&this._name.slice(-3)==="..."&&(this.variadic=!0,this._name=this._name.slice(0,-3))}name(){return this._name}_concatValue(t,r){return r===this.defaultValue||!Array.isArray(r)?[t]:r.concat(t)}default(t,r){return this.defaultValue=t,this.defaultValueDescription=r,this}argParser(t){return this.parseArg=t,this}choices(t){return this.argChoices=t.slice(),this.parseArg=(r,i)=>{if(!this.argChoices.includes(r))throw new is(`Allowed choices are ${this.argChoices.join(", ")}.`);return this.variadic?this._concatValue(r,i):r},this}argRequired(){return this.required=!0,this}argOptional(){return this.required=!1,this}};function ns(e){let t=e.name()+(e.variadic===!0?"...":"");return e.required?"<"+t+">":"["+t+"]"}et.Argument=Ze;et.humanReadableArgName=ns});var it=E(rt=>{var{humanReadableArgName:ss}=Se(),tt=class{constructor(){this.helpWidth=void 0,this.minWidthToWrap=40,this.sortSubcommands=!1,this.sortOptions=!1,this.showGlobalOptions=!1}prepareContext(t){this.helpWidth=this.helpWidth??t.helpWidth??80}visibleCommands(t){let r=t.commands.filter(n=>!n._hidden),i=t._getHelpCommand();return i&&!i._hidden&&r.push(i),this.sortSubcommands&&r.sort((n,s)=>n.name().localeCompare(s.name())),r}compareOptions(t,r){let i=n=>n.short?n.short.replace(/^-/,""):n.long.replace(/^--/,"");return i(t).localeCompare(i(r))}visibleOptions(t){let r=t.options.filter(n=>!n.hidden),i=t._getHelpOption();if(i&&!i.hidden){let n=i.short&&t._findOption(i.short),s=i.long&&t._findOption(i.long);!n&&!s?r.push(i):i.long&&!s?r.push(t.createOption(i.long,i.description)):i.short&&!n&&r.push(t.createOption(i.short,i.description))}return this.sortOptions&&r.sort(this.compareOptions),r}visibleGlobalOptions(t){if(!this.showGlobalOptions)return[];let r=[];for(let i=t.parent;i;i=i.parent){let n=i.options.filter(s=>!s.hidden);r.push(...n)}return this.sortOptions&&r.sort(this.compareOptions),r}visibleArguments(t){return t._argsDescription&&t.registeredArguments.forEach(r=>{r.description=r.description||t._argsDescription[r.name()]||""}),t.registeredArguments.find(r=>r.description)?t.registeredArguments:[]}subcommandTerm(t){let r=t.registeredArguments.map(i=>ss(i)).join(" ");return t._name+(t._aliases[0]?"|"+t._aliases[0]:"")+(t.options.length?" [options]":"")+(r?" "+r:"")}optionTerm(t){return t.flags}argumentTerm(t){return t.name()}longestSubcommandTermLength(t,r){return r.visibleCommands(t).reduce((i,n)=>Math.max(i,this.displayWidth(r.styleSubcommandTerm(r.subcommandTerm(n)))),0)}longestOptionTermLength(t,r){return r.visibleOptions(t).reduce((i,n)=>Math.max(i,this.displayWidth(r.styleOptionTerm(r.optionTerm(n)))),0)}longestGlobalOptionTermLength(t,r){return r.visibleGlobalOptions(t).reduce((i,n)=>Math.max(i,this.displayWidth(r.styleOptionTerm(r.optionTerm(n)))),0)}longestArgumentTermLength(t,r){return r.visibleArguments(t).reduce((i,n)=>Math.max(i,this.displayWidth(r.styleArgumentTerm(r.argumentTerm(n)))),0)}commandUsage(t){let r=t._name;t._aliases[0]&&(r=r+"|"+t._aliases[0]);let i="";for(let n=t.parent;n;n=n.parent)i=n.name()+" "+i;return i+r+" "+t.usage()}commandDescription(t){return t.description()}subcommandDescription(t){return t.summary()||t.description()}optionDescription(t){let r=[];if(t.argChoices&&r.push(`choices: ${t.argChoices.map(i=>JSON.stringify(i)).join(", ")}`),t.defaultValue!==void 0&&(t.required||t.optional||t.isBoolean()&&typeof t.defaultValue=="boolean")&&r.push(`default: ${t.defaultValueDescription||JSON.stringify(t.defaultValue)}`),t.presetArg!==void 0&&t.optional&&r.push(`preset: ${JSON.stringify(t.presetArg)}`),t.envVar!==void 0&&r.push(`env: ${t.envVar}`),r.length>0){let i=`(${r.join(", ")})`;return t.description?`${t.description} ${i}`:i}return t.description}argumentDescription(t){let r=[];if(t.argChoices&&r.push(`choices: ${t.argChoices.map(i=>JSON.stringify(i)).join(", ")}`),t.defaultValue!==void 0&&r.push(`default: ${t.defaultValueDescription||JSON.stringify(t.defaultValue)}`),r.length>0){let i=`(${r.join(", ")})`;return t.description?`${t.description} ${i}`:i}return t.description}formatItemList(t,r,i){return r.length===0?[]:[i.styleTitle(t),...r,""]}groupItems(t,r,i){let n=new Map;return t.forEach(s=>{let a=i(s);n.has(a)||n.set(a,[])}),r.forEach(s=>{let a=i(s);n.has(a)||n.set(a,[]),n.get(a).push(s)}),n}formatHelp(t,r){let i=r.padWidth(t,r),n=r.helpWidth??80;function s(d,x){return r.formatItem(d,i,x,r)}let a=[`${r.styleTitle("Usage:")} ${r.styleUsage(r.commandUsage(t))}`,""],l=r.commandDescription(t);l.length>0&&(a=a.concat([r.boxWrap(r.styleCommandDescription(l),n),""]));let c=r.visibleArguments(t).map(d=>s(r.styleArgumentTerm(r.argumentTerm(d)),r.styleArgumentDescription(r.argumentDescription(d))));if(a=a.concat(this.formatItemList("Arguments:",c,r)),this.groupItems(t.options,r.visibleOptions(t),d=>d.helpGroupHeading??"Options:").forEach((d,x)=>{let U=d.map(H=>s(r.styleOptionTerm(r.optionTerm(H)),r.styleOptionDescription(r.optionDescription(H))));a=a.concat(this.formatItemList(x,U,r))}),r.showGlobalOptions){let d=r.visibleGlobalOptions(t).map(x=>s(r.styleOptionTerm(r.optionTerm(x)),r.styleOptionDescription(r.optionDescription(x))));a=a.concat(this.formatItemList("Global Options:",d,r))}return this.groupItems(t.commands,r.visibleCommands(t),d=>d.helpGroup()||"Commands:").forEach((d,x)=>{let U=d.map(H=>s(r.styleSubcommandTerm(r.subcommandTerm(H)),r.styleSubcommandDescription(r.subcommandDescription(H))));a=a.concat(this.formatItemList(x,U,r))}),a.join(`
`)}displayWidth(t){return tr(t).length}styleTitle(t){return t}styleUsage(t){return t.split(" ").map(r=>r==="[options]"?this.styleOptionText(r):r==="[command]"?this.styleSubcommandText(r):r[0]==="["||r[0]==="<"?this.styleArgumentText(r):this.styleCommandText(r)).join(" ")}styleCommandDescription(t){return this.styleDescriptionText(t)}styleOptionDescription(t){return this.styleDescriptionText(t)}styleSubcommandDescription(t){return this.styleDescriptionText(t)}styleArgumentDescription(t){return this.styleDescriptionText(t)}styleDescriptionText(t){return t}styleOptionTerm(t){return this.styleOptionText(t)}styleSubcommandTerm(t){return t.split(" ").map(r=>r==="[options]"?this.styleOptionText(r):r[0]==="["||r[0]==="<"?this.styleArgumentText(r):this.styleSubcommandText(r)).join(" ")}styleArgumentTerm(t){return this.styleArgumentText(t)}styleOptionText(t){return t}styleArgumentText(t){return t}styleSubcommandText(t){return t}styleCommandText(t){return t}padWidth(t,r){return Math.max(r.longestOptionTermLength(t,r),r.longestGlobalOptionTermLength(t,r),r.longestSubcommandTermLength(t,r),r.longestArgumentTermLength(t,r))}preformatted(t){return/\n[^\S\r\n]/.test(t)}formatItem(t,r,i,n){let a=" ".repeat(2);if(!i)return a+t;let l=t.padEnd(r+t.length-n.displayWidth(t)),c=2,m=(this.helpWidth??80)-r-c-2,d;return m<this.minWidthToWrap||n.preformatted(i)?d=i:d=n.boxWrap(i,m).replace(/\n/g,`
`+" ".repeat(r+c)),a+l+" ".repeat(c)+d.replace(/\n/g,`
${a}`)}boxWrap(t,r){if(r<this.minWidthToWrap)return t;let i=t.split(/\r\n|\n/),n=/[\s]*[^\s]+/g,s=[];return i.forEach(a=>{let l=a.match(n);if(l===null){s.push("");return}let c=[l.shift()],f=this.displayWidth(c[0]);l.forEach(m=>{let d=this.displayWidth(m);if(f+d<=r){c.push(m),f+=d;return}s.push(c.join(""));let x=m.trimStart();c=[x],f=this.displayWidth(x)}),s.push(c.join(""))}),s.join(`
`)}};function tr(e){let t=/\x1b\[\d*(;\d*)*m/g;return e.replace(t,"")}rt.Help=tt;rt.stripColor=tr});var ot=E(at=>{var{InvalidArgumentError:as}=pe(),nt=class{constructor(t,r){this.flags=t,this.description=r||"",this.required=t.includes("<"),this.optional=t.includes("["),this.variadic=/\w\.\.\.[>\]]$/.test(t),this.mandatory=!1;let i=os(t);this.short=i.shortFlag,this.long=i.longFlag,this.negate=!1,this.long&&(this.negate=this.long.startsWith("--no-")),this.defaultValue=void 0,this.defaultValueDescription=void 0,this.presetArg=void 0,this.envVar=void 0,this.parseArg=void 0,this.hidden=!1,this.argChoices=void 0,this.conflictsWith=[],this.implied=void 0,this.helpGroupHeading=void 0}default(t,r){return this.defaultValue=t,this.defaultValueDescription=r,this}preset(t){return this.presetArg=t,this}conflicts(t){return this.conflictsWith=this.conflictsWith.concat(t),this}implies(t){let r=t;return typeof t=="string"&&(r={[t]:!0}),this.implied=Object.assign(this.implied||{},r),this}env(t){return this.envVar=t,this}argParser(t){return this.parseArg=t,this}makeOptionMandatory(t=!0){return this.mandatory=!!t,this}hideHelp(t=!0){return this.hidden=!!t,this}_concatValue(t,r){return r===this.defaultValue||!Array.isArray(r)?[t]:r.concat(t)}choices(t){return this.argChoices=t.slice(),this.parseArg=(r,i)=>{if(!this.argChoices.includes(r))throw new as(`Allowed choices are ${this.argChoices.join(", ")}.`);return this.variadic?this._concatValue(r,i):r},this}name(){return this.long?this.long.replace(/^--/,""):this.short.replace(/^-/,"")}attributeName(){return this.negate?rr(this.name().replace(/^no-/,"")):rr(this.name())}helpGroup(t){return this.helpGroupHeading=t,this}is(t){return this.short===t||this.long===t}isBoolean(){return!this.required&&!this.optional&&!this.negate}},st=class{constructor(t){this.positiveOptions=new Map,this.negativeOptions=new Map,this.dualOptions=new Set,t.forEach(r=>{r.negate?this.negativeOptions.set(r.attributeName(),r):this.positiveOptions.set(r.attributeName(),r)}),this.negativeOptions.forEach((r,i)=>{this.positiveOptions.has(i)&&this.dualOptions.add(i)})}valueFromOption(t,r){let i=r.attributeName();if(!this.dualOptions.has(i))return!0;let n=this.negativeOptions.get(i).presetArg,s=n!==void 0?n:!1;return r.negate===(s===t)}};function rr(e){return e.split("-").reduce((t,r)=>t+r[0].toUpperCase()+r.slice(1))}function os(e){let t,r,i=/^-[^-]$/,n=/^--[^-]/,s=e.split(/[ |,]+/).concat("guard");if(i.test(s[0])&&(t=s.shift()),n.test(s[0])&&(r=s.shift()),!t&&i.test(s[0])&&(t=s.shift()),!t&&n.test(s[0])&&(t=r,r=s.shift()),s[0].startsWith("-")){let a=s[0],l=`option creation failed due to '${a}' in option flags '${e}'`;throw/^-[^-][^-]/.test(a)?new Error(`${l}
- a short flag is a single dash and a single character
  - either use a single dash and a single character (for a short flag)
  - or use a double dash for a long option (and can have two, like '--ws, --workspace')`):i.test(a)?new Error(`${l}
- too many short flags`):n.test(a)?new Error(`${l}
- too many long flags`):new Error(`${l}
- unrecognised flag format`)}if(t===void 0&&r===void 0)throw new Error(`option creation failed due to no flags found in '${e}'.`);return{shortFlag:t,longFlag:r}}at.Option=nt;at.DualOptions=st});var nr=E(ir=>{function ls(e,t){if(Math.abs(e.length-t.length)>3)return Math.max(e.length,t.length);let r=[];for(let i=0;i<=e.length;i++)r[i]=[i];for(let i=0;i<=t.length;i++)r[0][i]=i;for(let i=1;i<=t.length;i++)for(let n=1;n<=e.length;n++){let s=1;e[n-1]===t[i-1]?s=0:s=1,r[n][i]=Math.min(r[n-1][i]+1,r[n][i-1]+1,r[n-1][i-1]+s),n>1&&i>1&&e[n-1]===t[i-2]&&e[n-2]===t[i-1]&&(r[n][i]=Math.min(r[n][i],r[n-2][i-2]+1))}return r[e.length][t.length]}function hs(e,t){if(!t||t.length===0)return"";t=Array.from(new Set(t));let r=e.startsWith("--");r&&(e=e.slice(2),t=t.map(a=>a.slice(2)));let i=[],n=3,s=.4;return t.forEach(a=>{if(a.length<=1)return;let l=ls(e,a),c=Math.max(e.length,a.length);(c-l)/c>s&&(l<n?(n=l,i=[a]):l===n&&i.push(a))}),i.sort((a,l)=>a.localeCompare(l)),r&&(i=i.map(a=>`--${a}`)),i.length>1?`
(Did you mean one of ${i.join(", ")}?)`:i.length===1?`
(Did you mean ${i[0]}?)`:""}ir.suggestSimilar=hs});var lr=E(ft=>{var cs=require("node:events").EventEmitter,lt=require("node:child_process"),X=require("node:path"),Ie=require("node:fs"),y=require("node:process"),{Argument:us,humanReadableArgName:fs}=Se(),{CommanderError:ht}=pe(),{Help:ds,stripColor:ms}=it(),{Option:sr,DualOptions:gs}=ot(),{suggestSimilar:ar}=nr(),ct=class e extends cs{constructor(t){super(),this.commands=[],this.options=[],this.parent=null,this._allowUnknownOption=!1,this._allowExcessArguments=!1,this.registeredArguments=[],this._args=this.registeredArguments,this.args=[],this.rawArgs=[],this.processedArgs=[],this._scriptPath=null,this._name=t||"",this._optionValues={},this._optionValueSources={},this._storeOptionsAsProperties=!1,this._actionHandler=null,this._executableHandler=!1,this._executableFile=null,this._executableDir=null,this._defaultCommandName=null,this._exitCallback=null,this._aliases=[],this._combineFlagAndOptionalValue=!0,this._description="",this._summary="",this._argsDescription=void 0,this._enablePositionalOptions=!1,this._passThroughOptions=!1,this._lifeCycleHooks={},this._showHelpAfterError=!1,this._showSuggestionAfterError=!0,this._savedState=null,this._outputConfiguration={writeOut:r=>y.stdout.write(r),writeErr:r=>y.stderr.write(r),outputError:(r,i)=>i(r),getOutHelpWidth:()=>y.stdout.isTTY?y.stdout.columns:void 0,getErrHelpWidth:()=>y.stderr.isTTY?y.stderr.columns:void 0,getOutHasColors:()=>ut()??(y.stdout.isTTY&&y.stdout.hasColors?.()),getErrHasColors:()=>ut()??(y.stderr.isTTY&&y.stderr.hasColors?.()),stripColor:r=>ms(r)},this._hidden=!1,this._helpOption=void 0,this._addImplicitHelpCommand=void 0,this._helpCommand=void 0,this._helpConfiguration={},this._helpGroupHeading=void 0,this._defaultCommandGroup=void 0,this._defaultOptionGroup=void 0}copyInheritedSettings(t){return this._outputConfiguration=t._outputConfiguration,this._helpOption=t._helpOption,this._helpCommand=t._helpCommand,this._helpConfiguration=t._helpConfiguration,this._exitCallback=t._exitCallback,this._storeOptionsAsProperties=t._storeOptionsAsProperties,this._combineFlagAndOptionalValue=t._combineFlagAndOptionalValue,this._allowExcessArguments=t._allowExcessArguments,this._enablePositionalOptions=t._enablePositionalOptions,this._showHelpAfterError=t._showHelpAfterError,this._showSuggestionAfterError=t._showSuggestionAfterError,this}_getCommandAndAncestors(){let t=[];for(let r=this;r;r=r.parent)t.push(r);return t}command(t,r,i){let n=r,s=i;typeof n=="object"&&n!==null&&(s=n,n=null),s=s||{};let[,a,l]=t.match(/([^ ]+) *(.*)/),c=this.createCommand(a);return n&&(c.description(n),c._executableHandler=!0),s.isDefault&&(this._defaultCommandName=c._name),c._hidden=!!(s.noHelp||s.hidden),c._executableFile=s.executableFile||null,l&&c.arguments(l),this._registerCommand(c),c.parent=this,c.copyInheritedSettings(this),n?this:c}createCommand(t){return new e(t)}createHelp(){return Object.assign(new ds,this.configureHelp())}configureHelp(t){return t===void 0?this._helpConfiguration:(this._helpConfiguration=t,this)}configureOutput(t){return t===void 0?this._outputConfiguration:(this._outputConfiguration=Object.assign({},this._outputConfiguration,t),this)}showHelpAfterError(t=!0){return typeof t!="string"&&(t=!!t),this._showHelpAfterError=t,this}showSuggestionAfterError(t=!0){return this._showSuggestionAfterError=!!t,this}addCommand(t,r){if(!t._name)throw new Error(`Command passed to .addCommand() must have a name
- specify the name in Command constructor or using .name()`);return r=r||{},r.isDefault&&(this._defaultCommandName=t._name),(r.noHelp||r.hidden)&&(t._hidden=!0),this._registerCommand(t),t.parent=this,t._checkForBrokenPassThrough(),this}createArgument(t,r){return new us(t,r)}argument(t,r,i,n){let s=this.createArgument(t,r);return typeof i=="function"?s.default(n).argParser(i):s.default(i),this.addArgument(s),this}arguments(t){return t.trim().split(/ +/).forEach(r=>{this.argument(r)}),this}addArgument(t){let r=this.registeredArguments.slice(-1)[0];if(r&&r.variadic)throw new Error(`only the last argument can be variadic '${r.name()}'`);if(t.required&&t.defaultValue!==void 0&&t.parseArg===void 0)throw new Error(`a default value for a required argument is never used: '${t.name()}'`);return this.registeredArguments.push(t),this}helpCommand(t,r){if(typeof t=="boolean")return this._addImplicitHelpCommand=t,t&&this._defaultCommandGroup&&this._initCommandGroup(this._getHelpCommand()),this;let i=t??"help [command]",[,n,s]=i.match(/([^ ]+) *(.*)/),a=r??"display help for command",l=this.createCommand(n);return l.helpOption(!1),s&&l.arguments(s),a&&l.description(a),this._addImplicitHelpCommand=!0,this._helpCommand=l,(t||r)&&this._initCommandGroup(l),this}addHelpCommand(t,r){return typeof t!="object"?(this.helpCommand(t,r),this):(this._addImplicitHelpCommand=!0,this._helpCommand=t,this._initCommandGroup(t),this)}_getHelpCommand(){return this._addImplicitHelpCommand??(this.commands.length&&!this._actionHandler&&!this._findCommand("help"))?(this._helpCommand===void 0&&this.helpCommand(void 0,void 0),this._helpCommand):null}hook(t,r){let i=["preSubcommand","preAction","postAction"];if(!i.includes(t))throw new Error(`Unexpected value for event passed to hook : '${t}'.
Expecting one of '${i.join("', '")}'`);return this._lifeCycleHooks[t]?this._lifeCycleHooks[t].push(r):this._lifeCycleHooks[t]=[r],this}exitOverride(t){return t?this._exitCallback=t:this._exitCallback=r=>{if(r.code!=="commander.executeSubCommandAsync")throw r},this}_exit(t,r,i){this._exitCallback&&this._exitCallback(new ht(t,r,i)),y.exit(t)}action(t){let r=i=>{let n=this.registeredArguments.length,s=i.slice(0,n);return this._storeOptionsAsProperties?s[n]=this:s[n]=this.opts(),s.push(this),t.apply(this,s)};return this._actionHandler=r,this}createOption(t,r){return new sr(t,r)}_callParseArg(t,r,i,n){try{return t.parseArg(r,i)}catch(s){if(s.code==="commander.invalidArgument"){let a=`${n} ${s.message}`;this.error(a,{exitCode:s.exitCode,code:s.code})}throw s}}_registerOption(t){let r=t.short&&this._findOption(t.short)||t.long&&this._findOption(t.long);if(r){let i=t.long&&this._findOption(t.long)?t.long:t.short;throw new Error(`Cannot add option '${t.flags}'${this._name&&` to command '${this._name}'`} due to conflicting flag '${i}'
-  already used by option '${r.flags}'`)}this._initOptionGroup(t),this.options.push(t)}_registerCommand(t){let r=n=>[n.name()].concat(n.aliases()),i=r(t).find(n=>this._findCommand(n));if(i){let n=r(this._findCommand(i)).join("|"),s=r(t).join("|");throw new Error(`cannot add command '${s}' as already have command '${n}'`)}this._initCommandGroup(t),this.commands.push(t)}addOption(t){this._registerOption(t);let r=t.name(),i=t.attributeName();if(t.negate){let s=t.long.replace(/^--no-/,"--");this._findOption(s)||this.setOptionValueWithSource(i,t.defaultValue===void 0?!0:t.defaultValue,"default")}else t.defaultValue!==void 0&&this.setOptionValueWithSource(i,t.defaultValue,"default");let n=(s,a,l)=>{s==null&&t.presetArg!==void 0&&(s=t.presetArg);let c=this.getOptionValue(i);s!==null&&t.parseArg?s=this._callParseArg(t,s,c,a):s!==null&&t.variadic&&(s=t._concatValue(s,c)),s==null&&(t.negate?s=!1:t.isBoolean()||t.optional?s=!0:s=""),this.setOptionValueWithSource(i,s,l)};return this.on("option:"+r,s=>{let a=`error: option '${t.flags}' argument '${s}' is invalid.`;n(s,a,"cli")}),t.envVar&&this.on("optionEnv:"+r,s=>{let a=`error: option '${t.flags}' value '${s}' from env '${t.envVar}' is invalid.`;n(s,a,"env")}),this}_optionEx(t,r,i,n,s){if(typeof r=="object"&&r instanceof sr)throw new Error("To add an Option object use addOption() instead of option() or requiredOption()");let a=this.createOption(r,i);if(a.makeOptionMandatory(!!t.mandatory),typeof n=="function")a.default(s).argParser(n);else if(n instanceof RegExp){let l=n;n=(c,f)=>{let m=l.exec(c);return m?m[0]:f},a.default(s).argParser(n)}else a.default(n);return this.addOption(a)}option(t,r,i,n){return this._optionEx({},t,r,i,n)}requiredOption(t,r,i,n){return this._optionEx({mandatory:!0},t,r,i,n)}combineFlagAndOptionalValue(t=!0){return this._combineFlagAndOptionalValue=!!t,this}allowUnknownOption(t=!0){return this._allowUnknownOption=!!t,this}allowExcessArguments(t=!0){return this._allowExcessArguments=!!t,this}enablePositionalOptions(t=!0){return this._enablePositionalOptions=!!t,this}passThroughOptions(t=!0){return this._passThroughOptions=!!t,this._checkForBrokenPassThrough(),this}_checkForBrokenPassThrough(){if(this.parent&&this._passThroughOptions&&!this.parent._enablePositionalOptions)throw new Error(`passThroughOptions cannot be used for '${this._name}' without turning on enablePositionalOptions for parent command(s)`)}storeOptionsAsProperties(t=!0){if(this.options.length)throw new Error("call .storeOptionsAsProperties() before adding options");if(Object.keys(this._optionValues).length)throw new Error("call .storeOptionsAsProperties() before setting option values");return this._storeOptionsAsProperties=!!t,this}getOptionValue(t){return this._storeOptionsAsProperties?this[t]:this._optionValues[t]}setOptionValue(t,r){return this.setOptionValueWithSource(t,r,void 0)}setOptionValueWithSource(t,r,i){return this._storeOptionsAsProperties?this[t]=r:this._optionValues[t]=r,this._optionValueSources[t]=i,this}getOptionValueSource(t){return this._optionValueSources[t]}getOptionValueSourceWithGlobals(t){let r;return this._getCommandAndAncestors().forEach(i=>{i.getOptionValueSource(t)!==void 0&&(r=i.getOptionValueSource(t))}),r}_prepareUserArgs(t,r){if(t!==void 0&&!Array.isArray(t))throw new Error("first parameter to parse must be array or undefined");if(r=r||{},t===void 0&&r.from===void 0){y.versions?.electron&&(r.from="electron");let n=y.execArgv??[];(n.includes("-e")||n.includes("--eval")||n.includes("-p")||n.includes("--print"))&&(r.from="eval")}t===void 0&&(t=y.argv),this.rawArgs=t.slice();let i;switch(r.from){case void 0:case"node":this._scriptPath=t[1],i=t.slice(2);break;case"electron":y.defaultApp?(this._scriptPath=t[1],i=t.slice(2)):i=t.slice(1);break;case"user":i=t.slice(0);break;case"eval":i=t.slice(1);break;default:throw new Error(`unexpected parse option { from: '${r.from}' }`)}return!this._name&&this._scriptPath&&this.nameFromFilename(this._scriptPath),this._name=this._name||"program",i}parse(t,r){this._prepareForParse();let i=this._prepareUserArgs(t,r);return this._parseCommand([],i),this}async parseAsync(t,r){this._prepareForParse();let i=this._prepareUserArgs(t,r);return await this._parseCommand([],i),this}_prepareForParse(){this._savedState===null?this.saveStateBeforeParse():this.restoreStateBeforeParse()}saveStateBeforeParse(){this._savedState={_name:this._name,_optionValues:{...this._optionValues},_optionValueSources:{...this._optionValueSources}}}restoreStateBeforeParse(){if(this._storeOptionsAsProperties)throw new Error(`Can not call parse again when storeOptionsAsProperties is true.
- either make a new Command for each call to parse, or stop storing options as properties`);this._name=this._savedState._name,this._scriptPath=null,this.rawArgs=[],this._optionValues={...this._savedState._optionValues},this._optionValueSources={...this._savedState._optionValueSources},this.args=[],this.processedArgs=[]}_checkForMissingExecutable(t,r,i){if(Ie.existsSync(t))return;let n=r?`searched for local subcommand relative to directory '${r}'`:"no directory for search for local subcommand, use .executableDir() to supply a custom directory",s=`'${t}' does not exist
 - if '${i}' is not meant to be an executable command, remove description parameter from '.command()' and use '.description()' instead
 - if the default executable name is not suitable, use the executableFile option to supply a custom name or path
 - ${n}`;throw new Error(s)}_executeSubCommand(t,r){r=r.slice();let i=!1,n=[".js",".ts",".tsx",".mjs",".cjs"];function s(m,d){let x=X.resolve(m,d);if(Ie.existsSync(x))return x;if(n.includes(X.extname(d)))return;let U=n.find(H=>Ie.existsSync(`${x}${H}`));if(U)return`${x}${U}`}this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();let a=t._executableFile||`${this._name}-${t._name}`,l=this._executableDir||"";if(this._scriptPath){let m;try{m=Ie.realpathSync(this._scriptPath)}catch{m=this._scriptPath}l=X.resolve(X.dirname(m),l)}if(l){let m=s(l,a);if(!m&&!t._executableFile&&this._scriptPath){let d=X.basename(this._scriptPath,X.extname(this._scriptPath));d!==this._name&&(m=s(l,`${d}-${t._name}`))}a=m||a}i=n.includes(X.extname(a));let c;y.platform!=="win32"?i?(r.unshift(a),r=or(y.execArgv).concat(r),c=lt.spawn(y.argv[0],r,{stdio:"inherit"})):c=lt.spawn(a,r,{stdio:"inherit"}):(this._checkForMissingExecutable(a,l,t._name),r.unshift(a),r=or(y.execArgv).concat(r),c=lt.spawn(y.execPath,r,{stdio:"inherit"})),c.killed||["SIGUSR1","SIGUSR2","SIGTERM","SIGINT","SIGHUP"].forEach(d=>{y.on(d,()=>{c.killed===!1&&c.exitCode===null&&c.kill(d)})});let f=this._exitCallback;c.on("close",m=>{m=m??1,f?f(new ht(m,"commander.executeSubCommandAsync","(close)")):y.exit(m)}),c.on("error",m=>{if(m.code==="ENOENT")this._checkForMissingExecutable(a,l,t._name);else if(m.code==="EACCES")throw new Error(`'${a}' not executable`);if(!f)y.exit(1);else{let d=new ht(1,"commander.executeSubCommandAsync","(error)");d.nestedError=m,f(d)}}),this.runningCommand=c}_dispatchSubcommand(t,r,i){let n=this._findCommand(t);n||this.help({error:!0}),n._prepareForParse();let s;return s=this._chainOrCallSubCommandHook(s,n,"preSubcommand"),s=this._chainOrCall(s,()=>{if(n._executableHandler)this._executeSubCommand(n,r.concat(i));else return n._parseCommand(r,i)}),s}_dispatchHelpCommand(t){t||this.help();let r=this._findCommand(t);return r&&!r._executableHandler&&r.help(),this._dispatchSubcommand(t,[],[this._getHelpOption()?.long??this._getHelpOption()?.short??"--help"])}_checkNumberOfArguments(){this.registeredArguments.forEach((t,r)=>{t.required&&this.args[r]==null&&this.missingArgument(t.name())}),!(this.registeredArguments.length>0&&this.registeredArguments[this.registeredArguments.length-1].variadic)&&this.args.length>this.registeredArguments.length&&this._excessArguments(this.args)}_processArguments(){let t=(i,n,s)=>{let a=n;if(n!==null&&i.parseArg){let l=`error: command-argument value '${n}' is invalid for argument '${i.name()}'.`;a=this._callParseArg(i,n,s,l)}return a};this._checkNumberOfArguments();let r=[];this.registeredArguments.forEach((i,n)=>{let s=i.defaultValue;i.variadic?n<this.args.length?(s=this.args.slice(n),i.parseArg&&(s=s.reduce((a,l)=>t(i,l,a),i.defaultValue))):s===void 0&&(s=[]):n<this.args.length&&(s=this.args[n],i.parseArg&&(s=t(i,s,i.defaultValue))),r[n]=s}),this.processedArgs=r}_chainOrCall(t,r){return t&&t.then&&typeof t.then=="function"?t.then(()=>r()):r()}_chainOrCallHooks(t,r){let i=t,n=[];return this._getCommandAndAncestors().reverse().filter(s=>s._lifeCycleHooks[r]!==void 0).forEach(s=>{s._lifeCycleHooks[r].forEach(a=>{n.push({hookedCommand:s,callback:a})})}),r==="postAction"&&n.reverse(),n.forEach(s=>{i=this._chainOrCall(i,()=>s.callback(s.hookedCommand,this))}),i}_chainOrCallSubCommandHook(t,r,i){let n=t;return this._lifeCycleHooks[i]!==void 0&&this._lifeCycleHooks[i].forEach(s=>{n=this._chainOrCall(n,()=>s(this,r))}),n}_parseCommand(t,r){let i=this.parseOptions(r);if(this._parseOptionsEnv(),this._parseOptionsImplied(),t=t.concat(i.operands),r=i.unknown,this.args=t.concat(r),t&&this._findCommand(t[0]))return this._dispatchSubcommand(t[0],t.slice(1),r);if(this._getHelpCommand()&&t[0]===this._getHelpCommand().name())return this._dispatchHelpCommand(t[1]);if(this._defaultCommandName)return this._outputHelpIfRequested(r),this._dispatchSubcommand(this._defaultCommandName,t,r);this.commands.length&&this.args.length===0&&!this._actionHandler&&!this._defaultCommandName&&this.help({error:!0}),this._outputHelpIfRequested(i.unknown),this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();let n=()=>{i.unknown.length>0&&this.unknownOption(i.unknown[0])},s=`command:${this.name()}`;if(this._actionHandler){n(),this._processArguments();let a;return a=this._chainOrCallHooks(a,"preAction"),a=this._chainOrCall(a,()=>this._actionHandler(this.processedArgs)),this.parent&&(a=this._chainOrCall(a,()=>{this.parent.emit(s,t,r)})),a=this._chainOrCallHooks(a,"postAction"),a}if(this.parent&&this.parent.listenerCount(s))n(),this._processArguments(),this.parent.emit(s,t,r);else if(t.length){if(this._findCommand("*"))return this._dispatchSubcommand("*",t,r);this.listenerCount("command:*")?this.emit("command:*",t,r):this.commands.length?this.unknownCommand():(n(),this._processArguments())}else this.commands.length?(n(),this.help({error:!0})):(n(),this._processArguments())}_findCommand(t){if(t)return this.commands.find(r=>r._name===t||r._aliases.includes(t))}_findOption(t){return this.options.find(r=>r.is(t))}_checkForMissingMandatoryOptions(){this._getCommandAndAncestors().forEach(t=>{t.options.forEach(r=>{r.mandatory&&t.getOptionValue(r.attributeName())===void 0&&t.missingMandatoryOptionValue(r)})})}_checkForConflictingLocalOptions(){let t=this.options.filter(i=>{let n=i.attributeName();return this.getOptionValue(n)===void 0?!1:this.getOptionValueSource(n)!=="default"});t.filter(i=>i.conflictsWith.length>0).forEach(i=>{let n=t.find(s=>i.conflictsWith.includes(s.attributeName()));n&&this._conflictingOption(i,n)})}_checkForConflictingOptions(){this._getCommandAndAncestors().forEach(t=>{t._checkForConflictingLocalOptions()})}parseOptions(t){let r=[],i=[],n=r,s=t.slice();function a(f){return f.length>1&&f[0]==="-"}let l=f=>/^-\d*\.?\d+(e[+-]?\d+)?$/.test(f)?!this._getCommandAndAncestors().some(m=>m.options.map(d=>d.short).some(d=>/^-\d$/.test(d))):!1,c=null;for(;s.length;){let f=s.shift();if(f==="--"){n===i&&n.push(f),n.push(...s);break}if(c&&(!a(f)||l(f))){this.emit(`option:${c.name()}`,f);continue}if(c=null,a(f)){let m=this._findOption(f);if(m){if(m.required){let d=s.shift();d===void 0&&this.optionMissingArgument(m),this.emit(`option:${m.name()}`,d)}else if(m.optional){let d=null;s.length>0&&(!a(s[0])||l(s[0]))&&(d=s.shift()),this.emit(`option:${m.name()}`,d)}else this.emit(`option:${m.name()}`);c=m.variadic?m:null;continue}}if(f.length>2&&f[0]==="-"&&f[1]!=="-"){let m=this._findOption(`-${f[1]}`);if(m){m.required||m.optional&&this._combineFlagAndOptionalValue?this.emit(`option:${m.name()}`,f.slice(2)):(this.emit(`option:${m.name()}`),s.unshift(`-${f.slice(2)}`));continue}}if(/^--[^=]+=/.test(f)){let m=f.indexOf("="),d=this._findOption(f.slice(0,m));if(d&&(d.required||d.optional)){this.emit(`option:${d.name()}`,f.slice(m+1));continue}}if(n===r&&a(f)&&!(this.commands.length===0&&l(f))&&(n=i),(this._enablePositionalOptions||this._passThroughOptions)&&r.length===0&&i.length===0){if(this._findCommand(f)){r.push(f),s.length>0&&i.push(...s);break}else if(this._getHelpCommand()&&f===this._getHelpCommand().name()){r.push(f),s.length>0&&r.push(...s);break}else if(this._defaultCommandName){i.push(f),s.length>0&&i.push(...s);break}}if(this._passThroughOptions){n.push(f),s.length>0&&n.push(...s);break}n.push(f)}return{operands:r,unknown:i}}opts(){if(this._storeOptionsAsProperties){let t={},r=this.options.length;for(let i=0;i<r;i++){let n=this.options[i].attributeName();t[n]=n===this._versionOptionName?this._version:this[n]}return t}return this._optionValues}optsWithGlobals(){return this._getCommandAndAncestors().reduce((t,r)=>Object.assign(t,r.opts()),{})}error(t,r){this._outputConfiguration.outputError(`${t}
`,this._outputConfiguration.writeErr),typeof this._showHelpAfterError=="string"?this._outputConfiguration.writeErr(`${this._showHelpAfterError}
`):this._showHelpAfterError&&(this._outputConfiguration.writeErr(`
`),this.outputHelp({error:!0}));let i=r||{},n=i.exitCode||1,s=i.code||"commander.error";this._exit(n,s,t)}_parseOptionsEnv(){this.options.forEach(t=>{if(t.envVar&&t.envVar in y.env){let r=t.attributeName();(this.getOptionValue(r)===void 0||["default","config","env"].includes(this.getOptionValueSource(r)))&&(t.required||t.optional?this.emit(`optionEnv:${t.name()}`,y.env[t.envVar]):this.emit(`optionEnv:${t.name()}`))}})}_parseOptionsImplied(){let t=new gs(this.options),r=i=>this.getOptionValue(i)!==void 0&&!["default","implied"].includes(this.getOptionValueSource(i));this.options.filter(i=>i.implied!==void 0&&r(i.attributeName())&&t.valueFromOption(this.getOptionValue(i.attributeName()),i)).forEach(i=>{Object.keys(i.implied).filter(n=>!r(n)).forEach(n=>{this.setOptionValueWithSource(n,i.implied[n],"implied")})})}missingArgument(t){let r=`error: missing required argument '${t}'`;this.error(r,{code:"commander.missingArgument"})}optionMissingArgument(t){let r=`error: option '${t.flags}' argument missing`;this.error(r,{code:"commander.optionMissingArgument"})}missingMandatoryOptionValue(t){let r=`error: required option '${t.flags}' not specified`;this.error(r,{code:"commander.missingMandatoryOptionValue"})}_conflictingOption(t,r){let i=a=>{let l=a.attributeName(),c=this.getOptionValue(l),f=this.options.find(d=>d.negate&&l===d.attributeName()),m=this.options.find(d=>!d.negate&&l===d.attributeName());return f&&(f.presetArg===void 0&&c===!1||f.presetArg!==void 0&&c===f.presetArg)?f:m||a},n=a=>{let l=i(a),c=l.attributeName();return this.getOptionValueSource(c)==="env"?`environment variable '${l.envVar}'`:`option '${l.flags}'`},s=`error: ${n(t)} cannot be used with ${n(r)}`;this.error(s,{code:"commander.conflictingOption"})}unknownOption(t){if(this._allowUnknownOption)return;let r="";if(t.startsWith("--")&&this._showSuggestionAfterError){let n=[],s=this;do{let a=s.createHelp().visibleOptions(s).filter(l=>l.long).map(l=>l.long);n=n.concat(a),s=s.parent}while(s&&!s._enablePositionalOptions);r=ar(t,n)}let i=`error: unknown option '${t}'${r}`;this.error(i,{code:"commander.unknownOption"})}_excessArguments(t){if(this._allowExcessArguments)return;let r=this.registeredArguments.length,i=r===1?"":"s",s=`error: too many arguments${this.parent?` for '${this.name()}'`:""}. Expected ${r} argument${i} but got ${t.length}.`;this.error(s,{code:"commander.excessArguments"})}unknownCommand(){let t=this.args[0],r="";if(this._showSuggestionAfterError){let n=[];this.createHelp().visibleCommands(this).forEach(s=>{n.push(s.name()),s.alias()&&n.push(s.alias())}),r=ar(t,n)}let i=`error: unknown command '${t}'${r}`;this.error(i,{code:"commander.unknownCommand"})}version(t,r,i){if(t===void 0)return this._version;this._version=t,r=r||"-V, --version",i=i||"output the version number";let n=this.createOption(r,i);return this._versionOptionName=n.attributeName(),this._registerOption(n),this.on("option:"+n.name(),()=>{this._outputConfiguration.writeOut(`${t}
`),this._exit(0,"commander.version",t)}),this}description(t,r){return t===void 0&&r===void 0?this._description:(this._description=t,r&&(this._argsDescription=r),this)}summary(t){return t===void 0?this._summary:(this._summary=t,this)}alias(t){if(t===void 0)return this._aliases[0];let r=this;if(this.commands.length!==0&&this.commands[this.commands.length-1]._executableHandler&&(r=this.commands[this.commands.length-1]),t===r._name)throw new Error("Command alias can't be the same as its name");let i=this.parent?._findCommand(t);if(i){let n=[i.name()].concat(i.aliases()).join("|");throw new Error(`cannot add alias '${t}' to command '${this.name()}' as already have command '${n}'`)}return r._aliases.push(t),this}aliases(t){return t===void 0?this._aliases:(t.forEach(r=>this.alias(r)),this)}usage(t){if(t===void 0){if(this._usage)return this._usage;let r=this.registeredArguments.map(i=>fs(i));return[].concat(this.options.length||this._helpOption!==null?"[options]":[],this.commands.length?"[command]":[],this.registeredArguments.length?r:[]).join(" ")}return this._usage=t,this}name(t){return t===void 0?this._name:(this._name=t,this)}helpGroup(t){return t===void 0?this._helpGroupHeading??"":(this._helpGroupHeading=t,this)}commandsGroup(t){return t===void 0?this._defaultCommandGroup??"":(this._defaultCommandGroup=t,this)}optionsGroup(t){return t===void 0?this._defaultOptionGroup??"":(this._defaultOptionGroup=t,this)}_initOptionGroup(t){this._defaultOptionGroup&&!t.helpGroupHeading&&t.helpGroup(this._defaultOptionGroup)}_initCommandGroup(t){this._defaultCommandGroup&&!t.helpGroup()&&t.helpGroup(this._defaultCommandGroup)}nameFromFilename(t){return this._name=X.basename(t,X.extname(t)),this}executableDir(t){return t===void 0?this._executableDir:(this._executableDir=t,this)}helpInformation(t){let r=this.createHelp(),i=this._getOutputContext(t);r.prepareContext({error:i.error,helpWidth:i.helpWidth,outputHasColors:i.hasColors});let n=r.formatHelp(this,r);return i.hasColors?n:this._outputConfiguration.stripColor(n)}_getOutputContext(t){t=t||{};let r=!!t.error,i,n,s;return r?(i=l=>this._outputConfiguration.writeErr(l),n=this._outputConfiguration.getErrHasColors(),s=this._outputConfiguration.getErrHelpWidth()):(i=l=>this._outputConfiguration.writeOut(l),n=this._outputConfiguration.getOutHasColors(),s=this._outputConfiguration.getOutHelpWidth()),{error:r,write:l=>(n||(l=this._outputConfiguration.stripColor(l)),i(l)),hasColors:n,helpWidth:s}}outputHelp(t){let r;typeof t=="function"&&(r=t,t=void 0);let i=this._getOutputContext(t),n={error:i.error,write:i.write,command:this};this._getCommandAndAncestors().reverse().forEach(a=>a.emit("beforeAllHelp",n)),this.emit("beforeHelp",n);let s=this.helpInformation({error:i.error});if(r&&(s=r(s),typeof s!="string"&&!Buffer.isBuffer(s)))throw new Error("outputHelp callback must return a string or a Buffer");i.write(s),this._getHelpOption()?.long&&this.emit(this._getHelpOption().long),this.emit("afterHelp",n),this._getCommandAndAncestors().forEach(a=>a.emit("afterAllHelp",n))}helpOption(t,r){return typeof t=="boolean"?(t?(this._helpOption===null&&(this._helpOption=void 0),this._defaultOptionGroup&&this._initOptionGroup(this._getHelpOption())):this._helpOption=null,this):(this._helpOption=this.createOption(t??"-h, --help",r??"display help for command"),(t||r)&&this._initOptionGroup(this._helpOption),this)}_getHelpOption(){return this._helpOption===void 0&&this.helpOption(void 0,void 0),this._helpOption}addHelpOption(t){return this._helpOption=t,this._initOptionGroup(t),this}help(t){this.outputHelp(t);let r=Number(y.exitCode??0);r===0&&t&&typeof t!="function"&&t.error&&(r=1),this._exit(r,"commander.help","(outputHelp)")}addHelpText(t,r){let i=["beforeAll","before","after","afterAll"];if(!i.includes(t))throw new Error(`Unexpected value for position to addHelpText.
Expecting one of '${i.join("', '")}'`);let n=`${t}Help`;return this.on(n,s=>{let a;typeof r=="function"?a=r({error:s.error,command:s.command}):a=r,a&&s.write(`${a}
`)}),this}_outputHelpIfRequested(t){let r=this._getHelpOption();r&&t.find(n=>r.is(n))&&(this.outputHelp(),this._exit(0,"commander.helpDisplayed","(outputHelp)"))}};function or(e){return e.map(t=>{if(!t.startsWith("--inspect"))return t;let r,i="127.0.0.1",n="9229",s;return(s=t.match(/^(--inspect(-brk)?)$/))!==null?r=s[1]:(s=t.match(/^(--inspect(-brk|-port)?)=([^:]+)$/))!==null?(r=s[1],/^\d+$/.test(s[3])?n=s[3]:i=s[3]):(s=t.match(/^(--inspect(-brk|-port)?)=([^:]+):(\d+)$/))!==null&&(r=s[1],i=s[3],n=s[4]),r&&n!=="0"?`${r}=${i}:${parseInt(n)+1}`:t})}function ut(){if(y.env.NO_COLOR||y.env.FORCE_COLOR==="0"||y.env.FORCE_COLOR==="false")return!1;if(y.env.FORCE_COLOR||y.env.CLICOLOR_FORCE!==void 0)return!0}ft.Command=ct;ft.useColor=ut});var fr=E(q=>{var{Argument:hr}=Se(),{Command:dt}=lr(),{CommanderError:ps,InvalidArgumentError:cr}=pe(),{Help:bs}=it(),{Option:ur}=ot();q.program=new dt;q.createCommand=e=>new dt(e);q.createOption=(e,t)=>new ur(e,t);q.createArgument=(e,t)=>new hr(e,t);q.Command=dt;q.Option=ur;q.Argument=hr;q.Help=bs;q.CommanderError=ps;q.InvalidArgumentError=cr;q.InvalidOptionArgumentError=cr});var B=E((Kh,pr)=>{"use strict";var gr=function(e){return typeof e<"u"&&e!==null},ws=function(e){return typeof e=="object"},Es=function(e){return Object.prototype.toString.call(e)==="[object Object]"},vs=function(e){return typeof e=="function"},ys=function(e){return typeof e=="boolean"},xs=function(e){return e instanceof Buffer},_s=function(e){if(gr(e))switch(e.constructor){case Uint8Array:case Uint8ClampedArray:case Int8Array:case Uint16Array:case Int16Array:case Uint32Array:case Int32Array:case Float32Array:case Float64Array:return!0}return!1},As=function(e){return e instanceof ArrayBuffer},Ps=function(e){return typeof e=="string"&&e.length>0},Cs=function(e){return typeof e=="number"&&!Number.isNaN(e)},$s=function(e){return Number.isInteger(e)},Ss=function(e,t,r){return e>=t&&e<=r},Is=function(e,t){return t.includes(e)},Os=function(e,t,r){return new Error(`Expected ${t} for ${e} but received ${r} of type ${typeof r}`)},Rs=function(e,t){return t.message=e.message,t};pr.exports={defined:gr,object:ws,plainObject:Es,fn:vs,bool:ys,buffer:xs,typedArray:_s,arrayBuffer:As,string:Ps,number:Cs,integer:$s,inRange:Ss,inArray:Is,invalidParameterError:Os,nativeError:Rs}});var Er=E((Yh,wr)=>{"use strict";var br=()=>process.platform==="linux",Oe=null,ks=()=>{if(!Oe)if(br()&&process.report){let e=process.report.excludeNetwork;process.report.excludeNetwork=!0,Oe=process.report.getReport(),process.report.excludeNetwork=e}else Oe={};return Oe};wr.exports={isLinux:br,getReport:ks}});var xr=E((Zh,yr)=>{"use strict";var vr=require("fs"),js="/usr/bin/ldd",Ls=e=>vr.readFileSync(e,"utf-8"),Ns=e=>new Promise((t,r)=>{vr.readFile(e,"utf-8",(i,n)=>{i?r(i):t(n)})});yr.exports={LDD_PATH:js,readFileSync:Ls,readFile:Ns}});var ke=E((ec,Dr)=>{"use strict";var Ar=require("child_process"),{isLinux:oe,getReport:Pr}=Er(),{LDD_PATH:Re,readFile:Cr,readFileSync:$r}=xr(),W,G,Sr="getconf GNU_LIBC_VERSION 2>&1 || true; ldd --version 2>&1 || true",K="",Ir=()=>K||new Promise(e=>{Ar.exec(Sr,(t,r)=>{K=t?" ":r,e(K)})}),Or=()=>{if(!K)try{K=Ar.execSync(Sr,{encoding:"utf8"})}catch{K=" "}return K},Y="glibc",Rr=/LIBC[a-z0-9 \-).]*?(\d+\.\d+)/i,ae="musl",Ts=e=>e.includes("libc.musl-")||e.includes("ld-musl-"),kr=()=>{let e=Pr();return e.header&&e.header.glibcVersionRuntime?Y:Array.isArray(e.sharedObjects)&&e.sharedObjects.some(Ts)?ae:null},jr=e=>{let[t,r]=e.split(/[\r\n]+/);return t&&t.includes(Y)?Y:r&&r.includes(ae)?ae:null},Lr=e=>e.includes("musl")?ae:e.includes("GNU C Library")?Y:null,Fs=async()=>{if(W!==void 0)return W;W=null;try{let e=await Cr(Re);W=Lr(e)}catch{}return W},qs=()=>{if(W!==void 0)return W;W=null;try{let e=$r(Re);W=Lr(e)}catch{}return W},Nr=async()=>{let e=null;if(oe()&&(e=await Fs(),e||(e=kr()),!e)){let t=await Ir();e=jr(t)}return e},Tr=()=>{let e=null;if(oe()&&(e=qs(),e||(e=kr()),!e)){let t=Or();e=jr(t)}return e},Ds=async()=>oe()&&await Nr()!==Y,Ms=()=>oe()&&Tr()!==Y,Hs=async()=>{if(G!==void 0)return G;G=null;try{let t=(await Cr(Re)).match(Rr);t&&(G=t[1])}catch{}return G},Bs=()=>{if(G!==void 0)return G;G=null;try{let t=$r(Re).match(Rr);t&&(G=t[1])}catch{}return G},Fr=()=>{let e=Pr();return e.header&&e.header.glibcVersionRuntime?e.header.glibcVersionRuntime:null},_r=e=>e.trim().split(/\s+/)[1],qr=e=>{let[t,r,i]=e.split(/[\r\n]+/);return t&&t.includes(Y)?_r(t):r&&i&&r.includes(ae)?_r(i):null},Ws=async()=>{let e=null;if(oe()&&(e=await Hs(),e||(e=Fr()),!e)){let t=await Ir();e=qr(t)}return e},Gs=()=>{let e=null;if(oe()&&(e=Bs(),e||(e=Fr()),!e)){let t=Or();e=qr(t)}return e};Dr.exports={GLIBC:Y,MUSL:ae,family:Nr,familySync:Tr,isNonGlibcLinux:Ds,isNonGlibcLinuxSync:Ms,version:Ws,versionSync:Gs}});var be=E((tc,Mr)=>{"use strict";var Vs=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};Mr.exports=Vs});var je=E((rc,Hr)=>{"use strict";var zs="2.0.0",Us=Number.MAX_SAFE_INTEGER||9007199254740991,Xs=16,Qs=250,Js=["major","premajor","minor","preminor","patch","prepatch","prerelease"];Hr.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:Xs,MAX_SAFE_BUILD_LENGTH:Qs,MAX_SAFE_INTEGER:Us,RELEASE_TYPES:Js,SEMVER_SPEC_VERSION:zs,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var we=E((V,Br)=>{"use strict";var{MAX_SAFE_COMPONENT_LENGTH:mt,MAX_SAFE_BUILD_LENGTH:Ks,MAX_LENGTH:Ys}=je(),Zs=be();V=Br.exports={};var ea=V.re=[],ta=V.safeRe=[],g=V.src=[],ra=V.safeSrc=[],p=V.t={},ia=0,gt="[a-zA-Z0-9-]",na=[["\\s",1],["\\d",Ys],[gt,Ks]],sa=e=>{for(let[t,r]of na)e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`);return e},v=(e,t,r)=>{let i=sa(t),n=ia++;Zs(e,n,t),p[e]=n,g[n]=t,ra[n]=i,ea[n]=new RegExp(t,r?"g":void 0),ta[n]=new RegExp(i,r?"g":void 0)};v("NUMERICIDENTIFIER","0|[1-9]\\d*");v("NUMERICIDENTIFIERLOOSE","\\d+");v("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${gt}*`);v("MAINVERSION",`(${g[p.NUMERICIDENTIFIER]})\\.(${g[p.NUMERICIDENTIFIER]})\\.(${g[p.NUMERICIDENTIFIER]})`);v("MAINVERSIONLOOSE",`(${g[p.NUMERICIDENTIFIERLOOSE]})\\.(${g[p.NUMERICIDENTIFIERLOOSE]})\\.(${g[p.NUMERICIDENTIFIERLOOSE]})`);v("PRERELEASEIDENTIFIER",`(?:${g[p.NONNUMERICIDENTIFIER]}|${g[p.NUMERICIDENTIFIER]})`);v("PRERELEASEIDENTIFIERLOOSE",`(?:${g[p.NONNUMERICIDENTIFIER]}|${g[p.NUMERICIDENTIFIERLOOSE]})`);v("PRERELEASE",`(?:-(${g[p.PRERELEASEIDENTIFIER]}(?:\\.${g[p.PRERELEASEIDENTIFIER]})*))`);v("PRERELEASELOOSE",`(?:-?(${g[p.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${g[p.PRERELEASEIDENTIFIERLOOSE]})*))`);v("BUILDIDENTIFIER",`${gt}+`);v("BUILD",`(?:\\+(${g[p.BUILDIDENTIFIER]}(?:\\.${g[p.BUILDIDENTIFIER]})*))`);v("FULLPLAIN",`v?${g[p.MAINVERSION]}${g[p.PRERELEASE]}?${g[p.BUILD]}?`);v("FULL",`^${g[p.FULLPLAIN]}$`);v("LOOSEPLAIN",`[v=\\s]*${g[p.MAINVERSIONLOOSE]}${g[p.PRERELEASELOOSE]}?${g[p.BUILD]}?`);v("LOOSE",`^${g[p.LOOSEPLAIN]}$`);v("GTLT","((?:<|>)?=?)");v("XRANGEIDENTIFIERLOOSE",`${g[p.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);v("XRANGEIDENTIFIER",`${g[p.NUMERICIDENTIFIER]}|x|X|\\*`);v("XRANGEPLAIN",`[v=\\s]*(${g[p.XRANGEIDENTIFIER]})(?:\\.(${g[p.XRANGEIDENTIFIER]})(?:\\.(${g[p.XRANGEIDENTIFIER]})(?:${g[p.PRERELEASE]})?${g[p.BUILD]}?)?)?`);v("XRANGEPLAINLOOSE",`[v=\\s]*(${g[p.XRANGEIDENTIFIERLOOSE]})(?:\\.(${g[p.XRANGEIDENTIFIERLOOSE]})(?:\\.(${g[p.XRANGEIDENTIFIERLOOSE]})(?:${g[p.PRERELEASELOOSE]})?${g[p.BUILD]}?)?)?`);v("XRANGE",`^${g[p.GTLT]}\\s*${g[p.XRANGEPLAIN]}$`);v("XRANGELOOSE",`^${g[p.GTLT]}\\s*${g[p.XRANGEPLAINLOOSE]}$`);v("COERCEPLAIN",`(^|[^\\d])(\\d{1,${mt}})(?:\\.(\\d{1,${mt}}))?(?:\\.(\\d{1,${mt}}))?`);v("COERCE",`${g[p.COERCEPLAIN]}(?:$|[^\\d])`);v("COERCEFULL",g[p.COERCEPLAIN]+`(?:${g[p.PRERELEASE]})?(?:${g[p.BUILD]})?(?:$|[^\\d])`);v("COERCERTL",g[p.COERCE],!0);v("COERCERTLFULL",g[p.COERCEFULL],!0);v("LONETILDE","(?:~>?)");v("TILDETRIM",`(\\s*)${g[p.LONETILDE]}\\s+`,!0);V.tildeTrimReplace="$1~";v("TILDE",`^${g[p.LONETILDE]}${g[p.XRANGEPLAIN]}$`);v("TILDELOOSE",`^${g[p.LONETILDE]}${g[p.XRANGEPLAINLOOSE]}$`);v("LONECARET","(?:\\^)");v("CARETTRIM",`(\\s*)${g[p.LONECARET]}\\s+`,!0);V.caretTrimReplace="$1^";v("CARET",`^${g[p.LONECARET]}${g[p.XRANGEPLAIN]}$`);v("CARETLOOSE",`^${g[p.LONECARET]}${g[p.XRANGEPLAINLOOSE]}$`);v("COMPARATORLOOSE",`^${g[p.GTLT]}\\s*(${g[p.LOOSEPLAIN]})$|^$`);v("COMPARATOR",`^${g[p.GTLT]}\\s*(${g[p.FULLPLAIN]})$|^$`);v("COMPARATORTRIM",`(\\s*)${g[p.GTLT]}\\s*(${g[p.LOOSEPLAIN]}|${g[p.XRANGEPLAIN]})`,!0);V.comparatorTrimReplace="$1$2$3";v("HYPHENRANGE",`^\\s*(${g[p.XRANGEPLAIN]})\\s+-\\s+(${g[p.XRANGEPLAIN]})\\s*$`);v("HYPHENRANGELOOSE",`^\\s*(${g[p.XRANGEPLAINLOOSE]})\\s+-\\s+(${g[p.XRANGEPLAINLOOSE]})\\s*$`);v("STAR","(<|>)?=?\\s*\\*");v("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");v("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var Le=E((ic,Wr)=>{"use strict";var aa=Object.freeze({loose:!0}),oa=Object.freeze({}),la=e=>e?typeof e!="object"?aa:e:oa;Wr.exports=la});var Ur=E((nc,zr)=>{"use strict";var Gr=/^[0-9]+$/,Vr=(e,t)=>{let r=Gr.test(e),i=Gr.test(t);return r&&i&&(e=+e,t=+t),e===t?0:r&&!i?-1:i&&!r?1:e<t?-1:1},ha=(e,t)=>Vr(t,e);zr.exports={compareIdentifiers:Vr,rcompareIdentifiers:ha}});var he=E((sc,Qr)=>{"use strict";var Ne=be(),{MAX_LENGTH:Xr,MAX_SAFE_INTEGER:Te}=je(),{safeRe:Fe,t:qe}=we(),ca=Le(),{compareIdentifiers:le}=Ur(),pt=class e{constructor(t,r){if(r=ca(r),t instanceof e){if(t.loose===!!r.loose&&t.includePrerelease===!!r.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>Xr)throw new TypeError(`version is longer than ${Xr} characters`);Ne("SemVer",t,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;let i=t.trim().match(r.loose?Fe[qe.LOOSE]:Fe[qe.FULL]);if(!i)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>Te||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Te||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Te||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map(n=>{if(/^[0-9]+$/.test(n)){let s=+n;if(s>=0&&s<Te)return s}return n}):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(Ne("SemVer.compare",this.version,this.options,t),!(t instanceof e)){if(typeof t=="string"&&t===this.version)return 0;t=new e(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof e||(t=new e(t,this.options)),le(this.major,t.major)||le(this.minor,t.minor)||le(this.patch,t.patch)}comparePre(t){if(t instanceof e||(t=new e(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let r=0;do{let i=this.prerelease[r],n=t.prerelease[r];if(Ne("prerelease compare",r,i,n),i===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(i===void 0)return-1;if(i===n)continue;return le(i,n)}while(++r)}compareBuild(t){t instanceof e||(t=new e(t,this.options));let r=0;do{let i=this.build[r],n=t.build[r];if(Ne("build compare",r,i,n),i===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(i===void 0)return-1;if(i===n)continue;return le(i,n)}while(++r)}inc(t,r,i){if(t.startsWith("pre")){if(!r&&i===!1)throw new Error("invalid increment argument: identifier is empty");if(r){let n=`-${r}`.match(this.options.loose?Fe[qe.PRERELEASELOOSE]:Fe[qe.PRERELEASE]);if(!n||n[1]!==r)throw new Error(`invalid identifier: ${r}`)}}switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,i);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,i);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,i),this.inc("pre",r,i);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,i),this.inc("pre",r,i);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let n=Number(i)?1:0;if(this.prerelease.length===0)this.prerelease=[n];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(r===this.prerelease.join(".")&&i===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(n)}}if(r){let s=[r,n];i===!1&&(s=[r]),le(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${t}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};Qr.exports=pt});var Yr=E((ac,Kr)=>{"use strict";var Jr=he(),ua=(e,t,r=!1)=>{if(e instanceof Jr)return e;try{return new Jr(e,t)}catch(i){if(!r)return null;throw i}};Kr.exports=ua});var ei=E((oc,Zr)=>{"use strict";var fa=he(),da=Yr(),{safeRe:De,t:Me}=we(),ma=(e,t)=>{if(e instanceof fa)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let r=null;if(!t.rtl)r=e.match(t.includePrerelease?De[Me.COERCEFULL]:De[Me.COERCE]);else{let c=t.includePrerelease?De[Me.COERCERTLFULL]:De[Me.COERCERTL],f;for(;(f=c.exec(e))&&(!r||r.index+r[0].length!==e.length);)(!r||f.index+f[0].length!==r.index+r[0].length)&&(r=f),c.lastIndex=f.index+f[1].length+f[2].length;c.lastIndex=-1}if(r===null)return null;let i=r[2],n=r[3]||"0",s=r[4]||"0",a=t.includePrerelease&&r[5]?`-${r[5]}`:"",l=t.includePrerelease&&r[6]?`+${r[6]}`:"";return da(`${i}.${n}.${s}${a}${l}`,t)};Zr.exports=ma});var ie=E((lc,ri)=>{"use strict";var ti=he(),ga=(e,t,r)=>new ti(e,r).compare(new ti(t,r));ri.exports=ga});var bt=E((hc,ii)=>{"use strict";var pa=ie(),ba=(e,t,r)=>pa(e,t,r)>=0;ii.exports=ba});var si=E((cc,ni)=>{"use strict";var wt=class{constructor(){this.max=1e3,this.map=new Map}get(t){let r=this.map.get(t);if(r!==void 0)return this.map.delete(t),this.map.set(t,r),r}delete(t){return this.map.delete(t)}set(t,r){if(!this.delete(t)&&r!==void 0){if(this.map.size>=this.max){let n=this.map.keys().next().value;this.delete(n)}this.map.set(t,r)}return this}};ni.exports=wt});var oi=E((uc,ai)=>{"use strict";var wa=ie(),Ea=(e,t,r)=>wa(e,t,r)===0;ai.exports=Ea});var hi=E((fc,li)=>{"use strict";var va=ie(),ya=(e,t,r)=>va(e,t,r)!==0;li.exports=ya});var ui=E((dc,ci)=>{"use strict";var xa=ie(),_a=(e,t,r)=>xa(e,t,r)>0;ci.exports=_a});var di=E((mc,fi)=>{"use strict";var Aa=ie(),Pa=(e,t,r)=>Aa(e,t,r)<0;fi.exports=Pa});var gi=E((gc,mi)=>{"use strict";var Ca=ie(),$a=(e,t,r)=>Ca(e,t,r)<=0;mi.exports=$a});var bi=E((pc,pi)=>{"use strict";var Sa=oi(),Ia=hi(),Oa=ui(),Ra=bt(),ka=di(),ja=gi(),La=(e,t,r,i)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e===r;case"!==":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e!==r;case"":case"=":case"==":return Sa(e,r,i);case"!=":return Ia(e,r,i);case">":return Oa(e,r,i);case">=":return Ra(e,r,i);case"<":return ka(e,r,i);case"<=":return ja(e,r,i);default:throw new TypeError(`Invalid operator: ${t}`)}};pi.exports=La});var Ai=E((bc,_i)=>{"use strict";var Ee=Symbol("SemVer ANY"),yt=class e{static get ANY(){return Ee}constructor(t,r){if(r=wi(r),t instanceof e){if(t.loose===!!r.loose)return t;t=t.value}t=t.trim().split(/\s+/).join(" "),vt("comparator",t,r),this.options=r,this.loose=!!r.loose,this.parse(t),this.semver===Ee?this.value="":this.value=this.operator+this.semver.version,vt("comp",this)}parse(t){let r=this.options.loose?Ei[vi.COMPARATORLOOSE]:Ei[vi.COMPARATOR],i=t.match(r);if(!i)throw new TypeError(`Invalid comparator: ${t}`);this.operator=i[1]!==void 0?i[1]:"",this.operator==="="&&(this.operator=""),i[2]?this.semver=new yi(i[2],this.options.loose):this.semver=Ee}toString(){return this.value}test(t){if(vt("Comparator.test",t,this.options.loose),this.semver===Ee||t===Ee)return!0;if(typeof t=="string")try{t=new yi(t,this.options)}catch{return!1}return Et(t,this.operator,this.semver,this.options)}intersects(t,r){if(!(t instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new xi(t.value,r).test(this.value):t.operator===""?t.value===""?!0:new xi(this.value,r).test(t.semver):(r=wi(r),r.includePrerelease&&(this.value==="<0.0.0-0"||t.value==="<0.0.0-0")||!r.includePrerelease&&(this.value.startsWith("<0.0.0")||t.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&t.operator.startsWith(">")||this.operator.startsWith("<")&&t.operator.startsWith("<")||this.semver.version===t.semver.version&&this.operator.includes("=")&&t.operator.includes("=")||Et(this.semver,"<",t.semver,r)&&this.operator.startsWith(">")&&t.operator.startsWith("<")||Et(this.semver,">",t.semver,r)&&this.operator.startsWith("<")&&t.operator.startsWith(">")))}};_i.exports=yt;var wi=Le(),{safeRe:Ei,t:vi}=we(),Et=bi(),vt=be(),yi=he(),xi=xt()});var xt=E((wc,Si)=>{"use strict";var Na=/\s+/g,_t=class e{constructor(t,r){if(r=Fa(r),t instanceof e)return t.loose===!!r.loose&&t.includePrerelease===!!r.includePrerelease?t:new e(t.raw,r);if(t instanceof At)return this.raw=t.value,this.set=[[t]],this.formatted=void 0,this;if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=t.trim().replace(Na," "),this.set=this.raw.split("||").map(i=>this.parseRange(i.trim())).filter(i=>i.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let i=this.set[0];if(this.set=this.set.filter(n=>!Ci(n[0])),this.set.length===0)this.set=[i];else if(this.set.length>1){for(let n of this.set)if(n.length===1&&Ga(n[0])){this.set=[n];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let t=0;t<this.set.length;t++){t>0&&(this.formatted+="||");let r=this.set[t];for(let i=0;i<r.length;i++)i>0&&(this.formatted+=" "),this.formatted+=r[i].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(t){let i=((this.options.includePrerelease&&Ba)|(this.options.loose&&Wa))+":"+t,n=Pi.get(i);if(n)return n;let s=this.options.loose,a=s?L[R.HYPHENRANGELOOSE]:L[R.HYPHENRANGE];t=t.replace(a,eo(this.options.includePrerelease)),P("hyphen replace",t),t=t.replace(L[R.COMPARATORTRIM],Da),P("comparator trim",t),t=t.replace(L[R.TILDETRIM],Ma),P("tilde trim",t),t=t.replace(L[R.CARETTRIM],Ha),P("caret trim",t);let l=t.split(" ").map(d=>Va(d,this.options)).join(" ").split(/\s+/).map(d=>Za(d,this.options));s&&(l=l.filter(d=>(P("loose invalid filter",d,this.options),!!d.match(L[R.COMPARATORLOOSE])))),P("range list",l);let c=new Map,f=l.map(d=>new At(d,this.options));for(let d of f){if(Ci(d))return[d];c.set(d.value,d)}c.size>1&&c.has("")&&c.delete("");let m=[...c.values()];return Pi.set(i,m),m}intersects(t,r){if(!(t instanceof e))throw new TypeError("a Range is required");return this.set.some(i=>$i(i,r)&&t.set.some(n=>$i(n,r)&&i.every(s=>n.every(a=>s.intersects(a,r)))))}test(t){if(!t)return!1;if(typeof t=="string")try{t=new qa(t,this.options)}catch{return!1}for(let r=0;r<this.set.length;r++)if(to(this.set[r],t,this.options))return!0;return!1}};Si.exports=_t;var Ta=si(),Pi=new Ta,Fa=Le(),At=Ai(),P=be(),qa=he(),{safeRe:L,t:R,comparatorTrimReplace:Da,tildeTrimReplace:Ma,caretTrimReplace:Ha}=we(),{FLAG_INCLUDE_PRERELEASE:Ba,FLAG_LOOSE:Wa}=je(),Ci=e=>e.value==="<0.0.0-0",Ga=e=>e.value==="",$i=(e,t)=>{let r=!0,i=e.slice(),n=i.pop();for(;r&&i.length;)r=i.every(s=>n.intersects(s,t)),n=i.pop();return r},Va=(e,t)=>(P("comp",e,t),e=Xa(e,t),P("caret",e),e=za(e,t),P("tildes",e),e=Ja(e,t),P("xrange",e),e=Ya(e,t),P("stars",e),e),k=e=>!e||e.toLowerCase()==="x"||e==="*",za=(e,t)=>e.trim().split(/\s+/).map(r=>Ua(r,t)).join(" "),Ua=(e,t)=>{let r=t.loose?L[R.TILDELOOSE]:L[R.TILDE];return e.replace(r,(i,n,s,a,l)=>{P("tilde",e,i,n,s,a,l);let c;return k(n)?c="":k(s)?c=`>=${n}.0.0 <${+n+1}.0.0-0`:k(a)?c=`>=${n}.${s}.0 <${n}.${+s+1}.0-0`:l?(P("replaceTilde pr",l),c=`>=${n}.${s}.${a}-${l} <${n}.${+s+1}.0-0`):c=`>=${n}.${s}.${a} <${n}.${+s+1}.0-0`,P("tilde return",c),c})},Xa=(e,t)=>e.trim().split(/\s+/).map(r=>Qa(r,t)).join(" "),Qa=(e,t)=>{P("caret",e,t);let r=t.loose?L[R.CARETLOOSE]:L[R.CARET],i=t.includePrerelease?"-0":"";return e.replace(r,(n,s,a,l,c)=>{P("caret",e,n,s,a,l,c);let f;return k(s)?f="":k(a)?f=`>=${s}.0.0${i} <${+s+1}.0.0-0`:k(l)?s==="0"?f=`>=${s}.${a}.0${i} <${s}.${+a+1}.0-0`:f=`>=${s}.${a}.0${i} <${+s+1}.0.0-0`:c?(P("replaceCaret pr",c),s==="0"?a==="0"?f=`>=${s}.${a}.${l}-${c} <${s}.${a}.${+l+1}-0`:f=`>=${s}.${a}.${l}-${c} <${s}.${+a+1}.0-0`:f=`>=${s}.${a}.${l}-${c} <${+s+1}.0.0-0`):(P("no pr"),s==="0"?a==="0"?f=`>=${s}.${a}.${l}${i} <${s}.${a}.${+l+1}-0`:f=`>=${s}.${a}.${l}${i} <${s}.${+a+1}.0-0`:f=`>=${s}.${a}.${l} <${+s+1}.0.0-0`),P("caret return",f),f})},Ja=(e,t)=>(P("replaceXRanges",e,t),e.split(/\s+/).map(r=>Ka(r,t)).join(" ")),Ka=(e,t)=>{e=e.trim();let r=t.loose?L[R.XRANGELOOSE]:L[R.XRANGE];return e.replace(r,(i,n,s,a,l,c)=>{P("xRange",e,i,n,s,a,l,c);let f=k(s),m=f||k(a),d=m||k(l),x=d;return n==="="&&x&&(n=""),c=t.includePrerelease?"-0":"",f?n===">"||n==="<"?i="<0.0.0-0":i="*":n&&x?(m&&(a=0),l=0,n===">"?(n=">=",m?(s=+s+1,a=0,l=0):(a=+a+1,l=0)):n==="<="&&(n="<",m?s=+s+1:a=+a+1),n==="<"&&(c="-0"),i=`${n+s}.${a}.${l}${c}`):m?i=`>=${s}.0.0${c} <${+s+1}.0.0-0`:d&&(i=`>=${s}.${a}.0${c} <${s}.${+a+1}.0-0`),P("xRange return",i),i})},Ya=(e,t)=>(P("replaceStars",e,t),e.trim().replace(L[R.STAR],"")),Za=(e,t)=>(P("replaceGTE0",e,t),e.trim().replace(L[t.includePrerelease?R.GTE0PRE:R.GTE0],"")),eo=e=>(t,r,i,n,s,a,l,c,f,m,d,x)=>(k(i)?r="":k(n)?r=`>=${i}.0.0${e?"-0":""}`:k(s)?r=`>=${i}.${n}.0${e?"-0":""}`:a?r=`>=${r}`:r=`>=${r}${e?"-0":""}`,k(f)?c="":k(m)?c=`<${+f+1}.0.0-0`:k(d)?c=`<${f}.${+m+1}.0-0`:x?c=`<=${f}.${m}.${d}-${x}`:e?c=`<${f}.${m}.${+d+1}-0`:c=`<=${c}`,`${r} ${c}`.trim()),to=(e,t,r)=>{for(let i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let i=0;i<e.length;i++)if(P(e[i].semver),e[i].semver!==At.ANY&&e[i].semver.prerelease.length>0){let n=e[i].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0}});var Oi=E((Ec,Ii)=>{"use strict";var ro=xt(),io=(e,t,r)=>{try{t=new ro(t,r)}catch{return!1}return t.test(e)};Ii.exports=io});var Pt=E((vc,no)=>{no.exports={name:"sharp",description:"High performance Node.js image processing, the fastest module to resize JPEG, PNG, WebP, GIF, AVIF and TIFF images",version:"0.34.3",author:"Lovell Fuller <npm@lovell.info>",homepage:"https://sharp.pixelplumbing.com",contributors:["Pierre Inglebert <pierre.inglebert@gmail.com>","Jonathan Ong <jonathanrichardong@gmail.com>","Chanon Sajjamanochai <chanon.s@gmail.com>","Juliano Julio <julianojulio@gmail.com>","Daniel Gasienica <daniel@gasienica.ch>","Julian Walker <julian@fiftythree.com>","Amit Pitaru <pitaru.amit@gmail.com>","Brandon Aaron <hello.brandon@aaron.sh>","Andreas Lind <andreas@one.com>","Maurus Cuelenaere <mcuelenaere@gmail.com>","Linus Unneb\xE4ck <linus@folkdatorn.se>","Victor Mateevitsi <mvictoras@gmail.com>","Alaric Holloway <alaric.holloway@gmail.com>","Bernhard K. Weisshuhn <bkw@codingforce.com>","Chris Riley <criley@primedia.com>","David Carley <dacarley@gmail.com>","John Tobin <john@limelightmobileinc.com>","Kenton Gray <kentongray@gmail.com>","Felix B\xFCnemann <Felix.Buenemann@gmail.com>","Samy Al Zahrani <samyalzahrany@gmail.com>","Chintan Thakkar <lemnisk8@gmail.com>","F. Orlando Galashan <frulo@gmx.de>","Kleis Auke Wolthuizen <info@kleisauke.nl>","Matt Hirsch <mhirsch@media.mit.edu>","Matthias Thoemmes <thoemmes@gmail.com>","Patrick Paskaris <patrick@paskaris.gr>","J\xE9r\xE9my Lal <kapouer@melix.org>","Rahul Nanwani <r.nanwani@gmail.com>","Alice Monday <alice0meta@gmail.com>","Kristo Jorgenson <kristo.jorgenson@gmail.com>","YvesBos <yves_bos@outlook.com>","Guy Maliar <guy@tailorbrands.com>","Nicolas Coden <nicolas@ncoden.fr>","Matt Parrish <matt.r.parrish@gmail.com>","Marcel Bretschneider <marcel.bretschneider@gmail.com>","Matthew McEachen <matthew+github@mceachen.org>","Jarda Kot\u011B\u0161ovec <jarda.kotesovec@gmail.com>","Kenric D'Souza <kenric.dsouza@gmail.com>","Oleh Aleinyk <oleg.aleynik@gmail.com>","Marcel Bretschneider <marcel.bretschneider@gmail.com>","Andrea Bianco <andrea.bianco@unibas.ch>","Rik Heywood <rik@rik.org>","Thomas Parisot <hi@oncletom.io>","Nathan Graves <nathanrgraves+github@gmail.com>","Tom Lokhorst <tom@lokhorst.eu>","Espen Hovlandsdal <espen@hovlandsdal.com>","Sylvain Dumont <sylvain.dumont35@gmail.com>","Alun Davies <alun.owain.davies@googlemail.com>","Aidan Hoolachan <ajhoolachan21@gmail.com>","Axel Eirola <axel.eirola@iki.fi>","Freezy <freezy@xbmc.org>","Daiz <taneli.vatanen@gmail.com>","Julian Aubourg <j@ubourg.net>","Keith Belovay <keith@picthrive.com>","Michael B. Klein <mbklein@gmail.com>","Jordan Prudhomme <jordan@raboland.fr>","Ilya Ovdin <iovdin@gmail.com>","Andargor <andargor@yahoo.com>","Paul Neave <paul.neave@gmail.com>","Brendan Kennedy <brenwken@gmail.com>","Brychan Bennett-Odlum <git@brychan.io>","Edward Silverton <e.silverton@gmail.com>","Roman Malieiev <aromaleev@gmail.com>","Tomas Szabo <tomas.szabo@deftomat.com>","Robert O'Rourke <robert@o-rourke.org>","Guillermo Alfonso Varela Chouci\xF1o <guillevch@gmail.com>","Christian Flintrup <chr@gigahost.dk>","Manan Jadhav <manan@motionden.com>","Leon Radley <leon@radley.se>","alza54 <alza54@thiocod.in>","Jacob Smith <jacob@frende.me>","Michael Nutt <michael@nutt.im>","Brad Parham <baparham@gmail.com>","Taneli Vatanen <taneli.vatanen@gmail.com>","Joris Dugu\xE9 <zaruike10@gmail.com>","Chris Banks <christopher.bradley.banks@gmail.com>","Ompal Singh <ompal.hitm09@gmail.com>","Brodan <christopher.hranj@gmail.com>","Ankur Parihar <ankur.github@gmail.com>","Brahim Ait elhaj <brahima@gmail.com>","Mart Jansink <m.jansink@gmail.com>","Lachlan Newman <lachnewman007@gmail.com>","Dennis Beatty <dennis@dcbeatty.com>","Ingvar Stepanyan <me@rreverser.com>","Don Denton <don@happycollision.com>"],scripts:{install:"node install/check.js",clean:"rm -rf src/build/ .nyc_output/ coverage/ test/fixtures/output.*",test:"npm run test-lint && npm run test-unit && npm run test-licensing && npm run test-types","test-lint":"semistandard && cpplint","test-unit":"nyc --reporter=lcov --reporter=text --check-coverage --branches=100 mocha","test-licensing":'license-checker --production --summary --onlyAllow="Apache-2.0;BSD;ISC;LGPL-3.0-or-later;MIT"',"test-leak":"./test/leak/leak.sh","test-types":"tsd","package-from-local-build":"node npm/from-local-build.js","docs-build":"node docs/build.mjs","docs-serve":"cd docs && npm start","docs-publish":"cd docs && npm run build && npx firebase-tools deploy --project pixelplumbing --only hosting:pixelplumbing-sharp"},type:"commonjs",main:"lib/index.js",types:"lib/index.d.ts",files:["install","lib","src/*.{cc,h,gyp}"],repository:{type:"git",url:"git://github.com/lovell/sharp.git"},keywords:["jpeg","png","webp","avif","tiff","gif","svg","jp2","dzi","image","resize","thumbnail","crop","embed","libvips","vips"],dependencies:{color:"^4.2.3","detect-libc":"^2.0.4",semver:"^7.7.2"},optionalDependencies:{"@img/sharp-darwin-arm64":"0.34.3","@img/sharp-darwin-x64":"0.34.3","@img/sharp-libvips-darwin-arm64":"1.2.0","@img/sharp-libvips-darwin-x64":"1.2.0","@img/sharp-libvips-linux-arm":"1.2.0","@img/sharp-libvips-linux-arm64":"1.2.0","@img/sharp-libvips-linux-ppc64":"1.2.0","@img/sharp-libvips-linux-s390x":"1.2.0","@img/sharp-libvips-linux-x64":"1.2.0","@img/sharp-libvips-linuxmusl-arm64":"1.2.0","@img/sharp-libvips-linuxmusl-x64":"1.2.0","@img/sharp-linux-arm":"0.34.3","@img/sharp-linux-arm64":"0.34.3","@img/sharp-linux-ppc64":"0.34.3","@img/sharp-linux-s390x":"0.34.3","@img/sharp-linux-x64":"0.34.3","@img/sharp-linuxmusl-arm64":"0.34.3","@img/sharp-linuxmusl-x64":"0.34.3","@img/sharp-wasm32":"0.34.3","@img/sharp-win32-arm64":"0.34.3","@img/sharp-win32-ia32":"0.34.3","@img/sharp-win32-x64":"0.34.3"},devDependencies:{"@emnapi/runtime":"^1.4.4","@img/sharp-libvips-dev":"1.2.0","@img/sharp-libvips-dev-wasm32":"1.2.0","@img/sharp-libvips-win32-arm64":"1.2.0","@img/sharp-libvips-win32-ia32":"1.2.0","@img/sharp-libvips-win32-x64":"1.2.0","@types/node":"*",cc:"^3.0.1",emnapi:"^1.4.4","exif-reader":"^2.0.2","extract-zip":"^2.0.1",icc:"^3.0.0","jsdoc-to-markdown":"^9.1.1","license-checker":"^25.0.1",mocha:"^11.7.1","node-addon-api":"^8.4.0","node-gyp":"^11.2.0",nyc:"^17.1.0",semistandard:"^17.0.0","tar-fs":"^3.1.0",tsd:"^0.32.0"},license:"Apache-2.0",engines:{node:"^18.17.0 || ^20.3.0 || >=21.0.0"},config:{libvips:">=8.17.1"},funding:{url:"https://opencollective.com/libvips"},semistandard:{env:["mocha"]},cc:{linelength:"120",filter:["build/include"]},nyc:{include:["lib"]},tsd:{directory:"test/types/"}}});var $t=E((yc,Mi)=>{"use strict";var{spawnSync:He}=require("node:child_process"),{createHash:so}=require("node:crypto"),Li=ei(),ao=bt(),oo=Oi(),Ri=ke(),{config:lo,engines:ki,optionalDependencies:ho}=Pt(),co=process.env.npm_package_config_libvips||lo.libvips,Ni=Li(co).version,uo=["darwin-arm64","darwin-x64","linux-arm","linux-arm64","linux-ppc64","linux-s390x","linux-x64","linuxmusl-arm64","linuxmusl-x64","win32-arm64","win32-ia32","win32-x64"],Be={encoding:"utf8",shell:!0},fo=e=>{e instanceof Error?console.error(`sharp: Installation error: ${e.message}`):console.log(`sharp: ${e}`)},Ti=()=>Ri.isNonGlibcLinuxSync()?Ri.familySync():"",mo=()=>`${process.platform}${Ti()}-${process.arch}`,ce=()=>{if(Fi())return"wasm32";let{npm_config_arch:e,npm_config_platform:t,npm_config_libc:r}=process.env,i=typeof r=="string"?r:Ti();return`${t||process.platform}${i}-${e||process.arch}`},go=()=>{try{return require(`@img/sharp-libvips-dev-${ce()}/include`)}catch{try{return require("@img/sharp-libvips-dev/include")}catch{}}return""},po=()=>{try{return require("@img/sharp-libvips-dev/cplusplus")}catch{}return""},bo=()=>{try{return require(`@img/sharp-libvips-dev-${ce()}/lib`)}catch{try{return require(`@img/sharp-libvips-${ce()}/lib`)}catch{}}return""},wo=()=>{if(process.release?.name==="node"&&process.versions&&!oo(process.versions.node,ki.node))return{found:process.versions.node,expected:ki.node}},Fi=()=>{let{CC:e}=process.env;return!!(e&&e.endsWith("/emcc"))},Eo=()=>process.platform==="darwin"&&process.arch==="x64"?(He("sysctl sysctl.proc_translated",Be).stdout||"").trim()==="sysctl.proc_translated: 1":!1,ji=e=>so("sha512").update(e).digest("hex"),vo=()=>{try{let e=ji(`imgsharp-libvips-${ce()}`),t=Li(ho[`@img/sharp-libvips-${ce()}`],{includePrerelease:!0}).version;return ji(`${e}npm:${t}`).slice(0,10)}catch{}return""},yo=()=>He(`node-gyp rebuild --directory=src ${Fi()?"--nodedir=emscripten":""}`,{...Be,stdio:"inherit"}).status,qi=()=>process.platform!=="win32"?(He("pkg-config --modversion vips-cpp",{...Be,env:{...process.env,PKG_CONFIG_PATH:Di()}}).stdout||"").trim():"",Di=()=>process.platform!=="win32"?[(He('which brew >/dev/null 2>&1 && brew environment --plain | grep PKG_CONFIG_LIBDIR | cut -d" " -f2',Be).stdout||"").trim(),process.env.PKG_CONFIG_PATH,"/usr/local/lib/pkgconfig","/usr/lib/pkgconfig","/usr/local/libdata/pkgconfig","/usr/libdata/pkgconfig"].filter(Boolean).join(":"):"",Ct=(e,t,r)=>(r&&r(`Detected ${t}, skipping search for globally-installed libvips`),e),xo=e=>{if(process.env.SHARP_IGNORE_GLOBAL_LIBVIPS)return Ct(!1,"SHARP_IGNORE_GLOBAL_LIBVIPS",e);if(process.env.SHARP_FORCE_GLOBAL_LIBVIPS)return Ct(!0,"SHARP_FORCE_GLOBAL_LIBVIPS",e);if(Eo())return Ct(!1,"Rosetta",e);let t=qi();return!!t&&ao(t,Ni)};Mi.exports={minimumLibvipsVersion:Ni,prebuiltPlatforms:uo,buildPlatformArch:ce,buildSharpLibvipsIncludeDir:go,buildSharpLibvipsCPlusPlusDir:po,buildSharpLibvipsLibDir:bo,isUnsupportedNodeRuntime:wo,runtimePlatformArch:mo,log:fo,yarnLocator:vo,spawnRebuild:yo,globalLibvipsVersion:qi,pkgConfigPath:Di,useGlobalLibvips:xo}});var ye=E((xc,Bi)=>{"use strict";var{familySync:_o,versionSync:Ao}=ke(),{runtimePlatformArch:Po,isUnsupportedNodeRuntime:Hi,prebuiltPlatforms:Co,minimumLibvipsVersion:$o}=$t(),ne=Po(),So=[`../src/build/Release/sharp-${ne}.node`,"../src/build/Release/sharp-wasm32.node",`@img/sharp-${ne}/sharp.node`,"@img/sharp-wasm32/sharp.node"],St,ue,ve=[];for(St of So)try{ue=require(St);break}catch(e){ve.push(e)}if(ue&&St.startsWith("@img/sharp-linux-x64")&&!ue._isUsingX64V2()){let e=new Error("Prebuilt binaries for linux-x64 require v2 microarchitecture");e.code="Unsupported CPU",ve.push(e),ue=null}if(ue)Bi.exports=ue;else{let[e,t,r]=["linux","darwin","win32"].map(s=>ne.startsWith(s)),i=[`Could not load the "sharp" module using the ${ne} runtime`];ve.forEach(s=>{s.code!=="MODULE_NOT_FOUND"&&i.push(`${s.code}: ${s.message}`)});let n=ve.map(s=>s.message).join(" ");if(i.push("Possible solutions:"),Hi()){let{found:s,expected:a}=Hi();i.push("- Please upgrade Node.js:",`    Found ${s}`,`    Requires ${a}`)}else if(Co.includes(ne)){let[s,a]=ne.split("-"),l=s.endsWith("musl")?" --libc=musl":"";i.push("- Ensure optional dependencies can be installed:","    npm install --include=optional sharp","- Ensure your package manager supports multi-platform installation:","    See https://sharp.pixelplumbing.com/install#cross-platform","- Add platform-specific dependencies:",`    npm install --os=${s.replace("musl","")}${l} --cpu=${a} sharp`)}else i.push(`- Manually install libvips >= ${$o}`,"- Add experimental WebAssembly-based dependencies:","    npm install --cpu=wasm32 sharp","    npm install @img/sharp-wasm32");if(e&&/(symbol not found|CXXABI_)/i.test(n))try{let{config:s}=require(`@img/sharp-libvips-${ne}/package`),a=`${_o()} ${Ao()}`,l=`${s.musl?"musl":"glibc"} ${s.musl||s.glibc}`;i.push("- Update your OS:",`    Found ${a}`,`    Requires ${l}`)}catch{}throw e&&/\/snap\/core[0-9]{2}/.test(n)&&i.push("- Remove the Node.js Snap, which does not support native modules","    snap remove node"),t&&/Incompatible library version/.test(n)&&i.push("- Update Homebrew:","    brew update && brew upgrade vips"),ve.some(s=>s.code==="ERR_DLOPEN_DISABLED")&&i.push("- Run Node.js without using the --no-addons flag"),r&&/The specified procedure could not be found/.test(n)&&i.push("- Using the canvas package on Windows?","    See https://sharp.pixelplumbing.com/install#canvas-and-windows","- Check for outdated versions of sharp in the dependency tree:","    npm ls sharp"),i.push("- Consult the installation documentation:","    See https://sharp.pixelplumbing.com/install"),new Error(i.join(`
`))}});var Gi=E((_c,Wi)=>{"use strict";var Io=require("node:util"),It=require("node:stream"),Oo=B();ye();var Ro=Io.debuglog("sharp"),se=function(e,t){if(arguments.length===1&&!Oo.defined(e))throw new Error("Invalid input");return this instanceof se?(It.Duplex.call(this),this.options={topOffsetPre:-1,leftOffsetPre:-1,widthPre:-1,heightPre:-1,topOffsetPost:-1,leftOffsetPost:-1,widthPost:-1,heightPost:-1,width:-1,height:-1,canvas:"crop",position:0,resizeBackground:[0,0,0,255],angle:0,rotationAngle:0,rotationBackground:[0,0,0,255],rotateBeforePreExtract:!1,flip:!1,flop:!1,extendTop:0,extendBottom:0,extendLeft:0,extendRight:0,extendBackground:[0,0,0,255],extendWith:"background",withoutEnlargement:!1,withoutReduction:!1,affineMatrix:[],affineBackground:[0,0,0,255],affineIdx:0,affineIdy:0,affineOdx:0,affineOdy:0,affineInterpolator:this.constructor.interpolators.bilinear,kernel:"lanczos3",fastShrinkOnLoad:!0,tint:[-1,0,0,0],flatten:!1,flattenBackground:[0,0,0],unflatten:!1,negate:!1,negateAlpha:!0,medianSize:0,blurSigma:0,precision:"integer",minAmpl:.2,sharpenSigma:0,sharpenM1:1,sharpenM2:2,sharpenX1:2,sharpenY2:10,sharpenY3:20,threshold:0,thresholdGrayscale:!0,trimBackground:[],trimThreshold:-1,trimLineArt:!1,dilateWidth:0,erodeWidth:0,gamma:0,gammaOut:0,greyscale:!1,normalise:!1,normaliseLower:1,normaliseUpper:99,claheWidth:0,claheHeight:0,claheMaxSlope:3,brightness:1,saturation:1,hue:0,lightness:0,booleanBufferIn:null,booleanFileIn:"",joinChannelIn:[],extractChannel:-1,removeAlpha:!1,ensureAlpha:-1,colourspace:"srgb",colourspacePipeline:"last",composite:[],fileOut:"",formatOut:"input",streamOut:!1,keepMetadata:0,withMetadataOrientation:-1,withMetadataDensity:0,withIccProfile:"",withExif:{},withExifMerge:!0,withXmp:"",resolveWithObject:!1,loop:-1,delay:[],jpegQuality:80,jpegProgressive:!1,jpegChromaSubsampling:"4:2:0",jpegTrellisQuantisation:!1,jpegOvershootDeringing:!1,jpegOptimiseScans:!1,jpegOptimiseCoding:!0,jpegQuantisationTable:0,pngProgressive:!1,pngCompressionLevel:6,pngAdaptiveFiltering:!1,pngPalette:!1,pngQuality:100,pngEffort:7,pngBitdepth:8,pngDither:1,jp2Quality:80,jp2TileHeight:512,jp2TileWidth:512,jp2Lossless:!1,jp2ChromaSubsampling:"4:4:4",webpQuality:80,webpAlphaQuality:100,webpLossless:!1,webpNearLossless:!1,webpSmartSubsample:!1,webpSmartDeblock:!1,webpPreset:"default",webpEffort:4,webpMinSize:!1,webpMixed:!1,gifBitdepth:8,gifEffort:7,gifDither:1,gifInterFrameMaxError:0,gifInterPaletteMaxError:3,gifKeepDuplicateFrames:!1,gifReuse:!0,gifProgressive:!1,tiffQuality:80,tiffCompression:"jpeg",tiffPredictor:"horizontal",tiffPyramid:!1,tiffMiniswhite:!1,tiffBitdepth:8,tiffTile:!1,tiffTileHeight:256,tiffTileWidth:256,tiffXres:1,tiffYres:1,tiffResolutionUnit:"inch",heifQuality:50,heifLossless:!1,heifCompression:"av1",heifEffort:4,heifChromaSubsampling:"4:4:4",heifBitdepth:8,jxlDistance:1,jxlDecodingTier:0,jxlEffort:7,jxlLossless:!1,rawDepth:"uchar",tileSize:256,tileOverlap:0,tileContainer:"fs",tileLayout:"dz",tileFormat:"last",tileDepth:"last",tileAngle:0,tileSkipBlanks:-1,tileBackground:[255,255,255,255],tileCentre:!1,tileId:"https://example.com/iiif",tileBasename:"",timeoutSeconds:0,linearA:[],linearB:[],pdfBackground:[255,255,255,255],debuglog:r=>{this.emit("warning",r),Ro(r)},queueListener:function(r){se.queue.emit("change",r)}},this.options.input=this._createInputDescriptor(e,t,{allowStream:!0}),this):new se(e,t)};Object.setPrototypeOf(se.prototype,It.Duplex.prototype);Object.setPrototypeOf(se,It.Duplex);function ko(){let e=this.constructor.call(),{debuglog:t,queueListener:r,...i}=this.options;return e.options=structuredClone(i),e.options.debuglog=t,e.options.queueListener=r,this._isStreamInput()&&this.on("finish",()=>{this._flattenBufferIn(),e.options.input.buffer=this.options.input.buffer,e.emit("finish")}),e}Object.assign(se.prototype,{clone:ko});Wi.exports=se});var Ui=E((Ac,zi)=>{"use strict";var h=B(),Z=ye(),jo={left:"low",top:"low",low:"low",center:"centre",centre:"centre",right:"high",bottom:"high",high:"high"},Lo=["failOn","limitInputPixels","unlimited","animated","autoOrient","density","ignoreIcc","page","pages","sequentialRead","jp2","openSlide","pdf","raw","svg","tiff","failOnError","openSlideLevel","pdfBackground","tiffSubifd"];function Vi(e){let t=Lo.filter(r=>h.defined(e[r])).map(r=>[r,e[r]]);return t.length?Object.fromEntries(t):void 0}function No(e,t,r){let i={autoOrient:!1,failOn:"warning",limitInputPixels:Math.pow(16383,2),ignoreIcc:!1,unlimited:!1,sequentialRead:!0};if(h.string(e))i.file=e;else if(h.buffer(e)){if(e.length===0)throw Error("Input Buffer is empty");i.buffer=e}else if(h.arrayBuffer(e)){if(e.byteLength===0)throw Error("Input bit Array is empty");i.buffer=Buffer.from(e,0,e.byteLength)}else if(h.typedArray(e)){if(e.length===0)throw Error("Input Bit Array is empty");i.buffer=Buffer.from(e.buffer,e.byteOffset,e.byteLength)}else if(h.plainObject(e)&&!h.defined(t))t=e,Vi(t)&&(i.buffer=[]);else if(!h.defined(e)&&!h.defined(t)&&h.object(r)&&r.allowStream)i.buffer=[];else if(Array.isArray(e))if(e.length>1)if(!this.options.joining)this.options.joining=!0,this.options.join=e.map(n=>this._createInputDescriptor(n));else throw new Error("Recursive join is unsupported");else throw new Error("Expected at least two images to join");else throw new Error(`Unsupported input '${e}' of type ${typeof e}${h.defined(t)?` when also providing options of type ${typeof t}`:""}`);if(h.object(t)){if(h.defined(t.failOnError))if(h.bool(t.failOnError))i.failOn=t.failOnError?"warning":"none";else throw h.invalidParameterError("failOnError","boolean",t.failOnError);if(h.defined(t.failOn))if(h.string(t.failOn)&&h.inArray(t.failOn,["none","truncated","error","warning"]))i.failOn=t.failOn;else throw h.invalidParameterError("failOn","one of: none, truncated, error, warning",t.failOn);if(h.defined(t.autoOrient))if(h.bool(t.autoOrient))i.autoOrient=t.autoOrient;else throw h.invalidParameterError("autoOrient","boolean",t.autoOrient);if(h.defined(t.density))if(h.inRange(t.density,1,1e5))i.density=t.density;else throw h.invalidParameterError("density","number between 1 and 100000",t.density);if(h.defined(t.ignoreIcc))if(h.bool(t.ignoreIcc))i.ignoreIcc=t.ignoreIcc;else throw h.invalidParameterError("ignoreIcc","boolean",t.ignoreIcc);if(h.defined(t.limitInputPixels))if(h.bool(t.limitInputPixels))i.limitInputPixels=t.limitInputPixels?Math.pow(16383,2):0;else if(h.integer(t.limitInputPixels)&&h.inRange(t.limitInputPixels,0,Number.MAX_SAFE_INTEGER))i.limitInputPixels=t.limitInputPixels;else throw h.invalidParameterError("limitInputPixels","positive integer",t.limitInputPixels);if(h.defined(t.unlimited))if(h.bool(t.unlimited))i.unlimited=t.unlimited;else throw h.invalidParameterError("unlimited","boolean",t.unlimited);if(h.defined(t.sequentialRead))if(h.bool(t.sequentialRead))i.sequentialRead=t.sequentialRead;else throw h.invalidParameterError("sequentialRead","boolean",t.sequentialRead);if(h.defined(t.raw)){if(h.object(t.raw)&&h.integer(t.raw.width)&&t.raw.width>0&&h.integer(t.raw.height)&&t.raw.height>0&&h.integer(t.raw.channels)&&h.inRange(t.raw.channels,1,4))switch(i.rawWidth=t.raw.width,i.rawHeight=t.raw.height,i.rawChannels=t.raw.channels,e.constructor){case Uint8Array:case Uint8ClampedArray:i.rawDepth="uchar";break;case Int8Array:i.rawDepth="char";break;case Uint16Array:i.rawDepth="ushort";break;case Int16Array:i.rawDepth="short";break;case Uint32Array:i.rawDepth="uint";break;case Int32Array:i.rawDepth="int";break;case Float32Array:i.rawDepth="float";break;case Float64Array:i.rawDepth="double";break;default:i.rawDepth="uchar";break}else throw new Error("Expected width, height and channels for raw pixel input");if(i.rawPremultiplied=!1,h.defined(t.raw.premultiplied))if(h.bool(t.raw.premultiplied))i.rawPremultiplied=t.raw.premultiplied;else throw h.invalidParameterError("raw.premultiplied","boolean",t.raw.premultiplied);if(i.rawPageHeight=0,h.defined(t.raw.pageHeight))if(h.integer(t.raw.pageHeight)&&t.raw.pageHeight>0&&t.raw.pageHeight<=t.raw.height){if(t.raw.height%t.raw.pageHeight!==0)throw new Error(`Expected raw.height ${t.raw.height} to be a multiple of raw.pageHeight ${t.raw.pageHeight}`);i.rawPageHeight=t.raw.pageHeight}else throw h.invalidParameterError("raw.pageHeight","positive integer",t.raw.pageHeight)}if(h.defined(t.animated))if(h.bool(t.animated))i.pages=t.animated?-1:1;else throw h.invalidParameterError("animated","boolean",t.animated);if(h.defined(t.pages))if(h.integer(t.pages)&&h.inRange(t.pages,-1,1e5))i.pages=t.pages;else throw h.invalidParameterError("pages","integer between -1 and 100000",t.pages);if(h.defined(t.page))if(h.integer(t.page)&&h.inRange(t.page,0,1e5))i.page=t.page;else throw h.invalidParameterError("page","integer between 0 and 100000",t.page);if(h.object(t.openSlide)&&h.defined(t.openSlide.level))if(h.integer(t.openSlide.level)&&h.inRange(t.openSlide.level,0,256))i.openSlideLevel=t.openSlide.level;else throw h.invalidParameterError("openSlide.level","integer between 0 and 256",t.openSlide.level);else if(h.defined(t.level))if(h.integer(t.level)&&h.inRange(t.level,0,256))i.openSlideLevel=t.level;else throw h.invalidParameterError("level","integer between 0 and 256",t.level);if(h.object(t.tiff)&&h.defined(t.tiff.subifd))if(h.integer(t.tiff.subifd)&&h.inRange(t.tiff.subifd,-1,1e5))i.tiffSubifd=t.tiff.subifd;else throw h.invalidParameterError("tiff.subifd","integer between -1 and 100000",t.tiff.subifd);else if(h.defined(t.subifd))if(h.integer(t.subifd)&&h.inRange(t.subifd,-1,1e5))i.tiffSubifd=t.subifd;else throw h.invalidParameterError("subifd","integer between -1 and 100000",t.subifd);if(h.object(t.svg)){if(h.defined(t.svg.stylesheet))if(h.string(t.svg.stylesheet))i.svgStylesheet=t.svg.stylesheet;else throw h.invalidParameterError("svg.stylesheet","string",t.svg.stylesheet);if(h.defined(t.svg.highBitdepth))if(h.bool(t.svg.highBitdepth))i.svgHighBitdepth=t.svg.highBitdepth;else throw h.invalidParameterError("svg.highBitdepth","boolean",t.svg.highBitdepth)}if(h.object(t.pdf)&&h.defined(t.pdf.background)?i.pdfBackground=this._getBackgroundColourOption(t.pdf.background):h.defined(t.pdfBackground)&&(i.pdfBackground=this._getBackgroundColourOption(t.pdfBackground)),h.object(t.jp2)&&h.defined(t.jp2.oneshot))if(h.bool(t.jp2.oneshot))i.jp2Oneshot=t.jp2.oneshot;else throw h.invalidParameterError("jp2.oneshot","boolean",t.jp2.oneshot);if(h.defined(t.create))if(h.object(t.create)&&h.integer(t.create.width)&&t.create.width>0&&h.integer(t.create.height)&&t.create.height>0&&h.integer(t.create.channels)){if(i.createWidth=t.create.width,i.createHeight=t.create.height,i.createChannels=t.create.channels,i.createPageHeight=0,h.defined(t.create.pageHeight))if(h.integer(t.create.pageHeight)&&t.create.pageHeight>0&&t.create.pageHeight<=t.create.height){if(t.create.height%t.create.pageHeight!==0)throw new Error(`Expected create.height ${t.create.height} to be a multiple of create.pageHeight ${t.create.pageHeight}`);i.createPageHeight=t.create.pageHeight}else throw h.invalidParameterError("create.pageHeight","positive integer",t.create.pageHeight);if(h.defined(t.create.noise)){if(!h.object(t.create.noise))throw new Error("Expected noise to be an object");if(t.create.noise.type!=="gaussian")throw new Error("Only gaussian noise is supported at the moment");if(i.createNoiseType=t.create.noise.type,!h.inRange(t.create.channels,1,4))throw h.invalidParameterError("create.channels","number between 1 and 4",t.create.channels);if(i.createNoiseMean=128,h.defined(t.create.noise.mean))if(h.number(t.create.noise.mean)&&h.inRange(t.create.noise.mean,0,1e4))i.createNoiseMean=t.create.noise.mean;else throw h.invalidParameterError("create.noise.mean","number between 0 and 10000",t.create.noise.mean);if(i.createNoiseSigma=30,h.defined(t.create.noise.sigma))if(h.number(t.create.noise.sigma)&&h.inRange(t.create.noise.sigma,0,1e4))i.createNoiseSigma=t.create.noise.sigma;else throw h.invalidParameterError("create.noise.sigma","number between 0 and 10000",t.create.noise.sigma)}else if(h.defined(t.create.background)){if(!h.inRange(t.create.channels,3,4))throw h.invalidParameterError("create.channels","number between 3 and 4",t.create.channels);i.createBackground=this._getBackgroundColourOption(t.create.background)}else throw new Error("Expected valid noise or background to create a new input image");delete i.buffer}else throw new Error("Expected valid width, height and channels to create a new input image");if(h.defined(t.text))if(h.object(t.text)&&h.string(t.text.text)){if(i.textValue=t.text.text,h.defined(t.text.height)&&h.defined(t.text.dpi))throw new Error("Expected only one of dpi or height");if(h.defined(t.text.font))if(h.string(t.text.font))i.textFont=t.text.font;else throw h.invalidParameterError("text.font","string",t.text.font);if(h.defined(t.text.fontfile))if(h.string(t.text.fontfile))i.textFontfile=t.text.fontfile;else throw h.invalidParameterError("text.fontfile","string",t.text.fontfile);if(h.defined(t.text.width))if(h.integer(t.text.width)&&t.text.width>0)i.textWidth=t.text.width;else throw h.invalidParameterError("text.width","positive integer",t.text.width);if(h.defined(t.text.height))if(h.integer(t.text.height)&&t.text.height>0)i.textHeight=t.text.height;else throw h.invalidParameterError("text.height","positive integer",t.text.height);if(h.defined(t.text.align))if(h.string(t.text.align)&&h.string(this.constructor.align[t.text.align]))i.textAlign=this.constructor.align[t.text.align];else throw h.invalidParameterError("text.align","valid alignment",t.text.align);if(h.defined(t.text.justify))if(h.bool(t.text.justify))i.textJustify=t.text.justify;else throw h.invalidParameterError("text.justify","boolean",t.text.justify);if(h.defined(t.text.dpi))if(h.integer(t.text.dpi)&&h.inRange(t.text.dpi,1,1e6))i.textDpi=t.text.dpi;else throw h.invalidParameterError("text.dpi","integer between 1 and 1000000",t.text.dpi);if(h.defined(t.text.rgba))if(h.bool(t.text.rgba))i.textRgba=t.text.rgba;else throw h.invalidParameterError("text.rgba","bool",t.text.rgba);if(h.defined(t.text.spacing))if(h.integer(t.text.spacing)&&h.inRange(t.text.spacing,-1e6,1e6))i.textSpacing=t.text.spacing;else throw h.invalidParameterError("text.spacing","integer between -1000000 and 1000000",t.text.spacing);if(h.defined(t.text.wrap))if(h.string(t.text.wrap)&&h.inArray(t.text.wrap,["word","char","word-char","none"]))i.textWrap=t.text.wrap;else throw h.invalidParameterError("text.wrap","one of: word, char, word-char, none",t.text.wrap);delete i.buffer}else throw new Error("Expected a valid string to create an image with text.");if(h.defined(t.join))if(h.defined(this.options.join)){if(h.defined(t.join.animated))if(h.bool(t.join.animated))i.joinAnimated=t.join.animated;else throw h.invalidParameterError("join.animated","boolean",t.join.animated);if(h.defined(t.join.across))if(h.integer(t.join.across)&&h.inRange(t.join.across,1,1e6))i.joinAcross=t.join.across;else throw h.invalidParameterError("join.across","integer between 1 and 100000",t.join.across);if(h.defined(t.join.shim))if(h.integer(t.join.shim)&&h.inRange(t.join.shim,0,1e6))i.joinShim=t.join.shim;else throw h.invalidParameterError("join.shim","integer between 0 and 100000",t.join.shim);if(h.defined(t.join.background)&&(i.joinBackground=this._getBackgroundColourOption(t.join.background)),h.defined(t.join.halign))if(h.string(t.join.halign)&&h.string(this.constructor.align[t.join.halign]))i.joinHalign=this.constructor.align[t.join.halign];else throw h.invalidParameterError("join.halign","valid alignment",t.join.halign);if(h.defined(t.join.valign))if(h.string(t.join.valign)&&h.string(this.constructor.align[t.join.valign]))i.joinValign=this.constructor.align[t.join.valign];else throw h.invalidParameterError("join.valign","valid alignment",t.join.valign)}else throw new Error("Expected input to be an array of images to join")}else if(h.defined(t))throw new Error("Invalid input options "+t);return i}function To(e,t,r){Array.isArray(this.options.input.buffer)?h.buffer(e)?(this.options.input.buffer.length===0&&this.on("finish",()=>{this.streamInFinished=!0}),this.options.input.buffer.push(e),r()):r(new Error("Non-Buffer data on Writable Stream")):r(new Error("Unexpected data on Writable Stream"))}function Fo(){this._isStreamInput()&&(this.options.input.buffer=Buffer.concat(this.options.input.buffer))}function qo(){return Array.isArray(this.options.input.buffer)}function Do(e){let t=Error();return h.fn(e)?(this._isStreamInput()?this.on("finish",()=>{this._flattenBufferIn(),Z.metadata(this.options,(r,i)=>{r?e(h.nativeError(r,t)):e(null,i)})}):Z.metadata(this.options,(r,i)=>{r?e(h.nativeError(r,t)):e(null,i)}),this):this._isStreamInput()?new Promise((r,i)=>{let n=()=>{this._flattenBufferIn(),Z.metadata(this.options,(s,a)=>{s?i(h.nativeError(s,t)):r(a)})};this.writableFinished?n():this.once("finish",n)}):new Promise((r,i)=>{Z.metadata(this.options,(n,s)=>{n?i(h.nativeError(n,t)):r(s)})})}function Mo(e){let t=Error();return h.fn(e)?(this._isStreamInput()?this.on("finish",()=>{this._flattenBufferIn(),Z.stats(this.options,(r,i)=>{r?e(h.nativeError(r,t)):e(null,i)})}):Z.stats(this.options,(r,i)=>{r?e(h.nativeError(r,t)):e(null,i)}),this):this._isStreamInput()?new Promise((r,i)=>{this.on("finish",function(){this._flattenBufferIn(),Z.stats(this.options,(n,s)=>{n?i(h.nativeError(n,t)):r(s)})})}):new Promise((r,i)=>{Z.stats(this.options,(n,s)=>{n?i(h.nativeError(n,t)):r(s)})})}zi.exports=function(e){Object.assign(e.prototype,{_inputOptionsFromObject:Vi,_createInputDescriptor:No,_write:To,_flattenBufferIn:Fo,_isStreamInput:qo,metadata:Do,stats:Mo}),e.align=jo}});var Zi=E((Pc,Yi)=>{"use strict";var w=B(),Qi={center:0,centre:0,north:1,east:2,south:3,west:4,northeast:5,southeast:6,southwest:7,northwest:8},Ji={top:1,right:2,bottom:3,left:4,"right top":5,"right bottom":6,"left bottom":7,"left top":8},Xi={background:"background",copy:"copy",repeat:"repeat",mirror:"mirror"},Ki={entropy:16,attention:17},Ot={nearest:"nearest",linear:"linear",cubic:"cubic",mitchell:"mitchell",lanczos2:"lanczos2",lanczos3:"lanczos3",mks2013:"mks2013",mks2021:"mks2021"},Ho={contain:"contain",cover:"cover",fill:"fill",inside:"inside",outside:"outside"},Bo={contain:"embed",cover:"crop",fill:"ignore_aspect",inside:"max",outside:"min"};function Rt(e){return e.angle%360!==0||e.input.autoOrient===!0||e.rotationAngle!==0}function We(e){return e.width!==-1||e.height!==-1}function Wo(e,t,r){if(We(this.options)&&this.options.debuglog("ignoring previous resize options"),this.options.widthPost!==-1&&this.options.debuglog("operation order will be: extract, resize, extract"),w.defined(e))if(w.object(e)&&!w.defined(r))r=e;else if(w.integer(e)&&e>0)this.options.width=e;else throw w.invalidParameterError("width","positive integer",e);else this.options.width=-1;if(w.defined(t))if(w.integer(t)&&t>0)this.options.height=t;else throw w.invalidParameterError("height","positive integer",t);else this.options.height=-1;if(w.object(r)){if(w.defined(r.width))if(w.integer(r.width)&&r.width>0)this.options.width=r.width;else throw w.invalidParameterError("width","positive integer",r.width);if(w.defined(r.height))if(w.integer(r.height)&&r.height>0)this.options.height=r.height;else throw w.invalidParameterError("height","positive integer",r.height);if(w.defined(r.fit)){let i=Bo[r.fit];if(w.string(i))this.options.canvas=i;else throw w.invalidParameterError("fit","valid fit",r.fit)}if(w.defined(r.position)){let i=w.integer(r.position)?r.position:Ki[r.position]||Ji[r.position]||Qi[r.position];if(w.integer(i)&&(w.inRange(i,0,8)||w.inRange(i,16,17)))this.options.position=i;else throw w.invalidParameterError("position","valid position/gravity/strategy",r.position)}if(this._setBackgroundColourOption("resizeBackground",r.background),w.defined(r.kernel))if(w.string(Ot[r.kernel]))this.options.kernel=Ot[r.kernel];else throw w.invalidParameterError("kernel","valid kernel name",r.kernel);w.defined(r.withoutEnlargement)&&this._setBooleanOption("withoutEnlargement",r.withoutEnlargement),w.defined(r.withoutReduction)&&this._setBooleanOption("withoutReduction",r.withoutReduction),w.defined(r.fastShrinkOnLoad)&&this._setBooleanOption("fastShrinkOnLoad",r.fastShrinkOnLoad)}return Rt(this.options)&&We(this.options)&&(this.options.rotateBeforePreExtract=!0),this}function Go(e){if(w.integer(e)&&e>0)this.options.extendTop=e,this.options.extendBottom=e,this.options.extendLeft=e,this.options.extendRight=e;else if(w.object(e)){if(w.defined(e.top))if(w.integer(e.top)&&e.top>=0)this.options.extendTop=e.top;else throw w.invalidParameterError("top","positive integer",e.top);if(w.defined(e.bottom))if(w.integer(e.bottom)&&e.bottom>=0)this.options.extendBottom=e.bottom;else throw w.invalidParameterError("bottom","positive integer",e.bottom);if(w.defined(e.left))if(w.integer(e.left)&&e.left>=0)this.options.extendLeft=e.left;else throw w.invalidParameterError("left","positive integer",e.left);if(w.defined(e.right))if(w.integer(e.right)&&e.right>=0)this.options.extendRight=e.right;else throw w.invalidParameterError("right","positive integer",e.right);if(this._setBackgroundColourOption("extendBackground",e.background),w.defined(e.extendWith))if(w.string(Xi[e.extendWith]))this.options.extendWith=Xi[e.extendWith];else throw w.invalidParameterError("extendWith","one of: background, copy, repeat, mirror",e.extendWith)}else throw w.invalidParameterError("extend","integer or object",e);return this}function Vo(e){let t=We(this.options)||this.options.widthPre!==-1?"Post":"Pre";return this.options[`width${t}`]!==-1&&this.options.debuglog("ignoring previous extract options"),["left","top","width","height"].forEach(function(r){let i=e[r];if(w.integer(i)&&i>=0)this.options[r+(r==="left"||r==="top"?"Offset":"")+t]=i;else throw w.invalidParameterError(r,"integer",i)},this),Rt(this.options)&&!We(this.options)&&(this.options.widthPre===-1||this.options.widthPost===-1)&&(this.options.rotateBeforePreExtract=!0),this}function zo(e){if(this.options.trimThreshold=10,w.defined(e))if(w.object(e)){if(w.defined(e.background)&&this._setBackgroundColourOption("trimBackground",e.background),w.defined(e.threshold))if(w.number(e.threshold)&&e.threshold>=0)this.options.trimThreshold=e.threshold;else throw w.invalidParameterError("threshold","positive number",e.threshold);w.defined(e.lineArt)&&this._setBooleanOption("trimLineArt",e.lineArt)}else throw w.invalidParameterError("trim","object",e);return Rt(this.options)&&(this.options.rotateBeforePreExtract=!0),this}Yi.exports=function(e){Object.assign(e.prototype,{resize:Wo,extend:Go,extract:Vo,trim:zo}),e.gravity=Qi,e.strategy=Ki,e.kernel=Ot,e.fit=Ho,e.position=Ji}});var tn=E((Cc,en)=>{"use strict";var _=B(),kt={clear:"clear",source:"source",over:"over",in:"in",out:"out",atop:"atop",dest:"dest","dest-over":"dest-over","dest-in":"dest-in","dest-out":"dest-out","dest-atop":"dest-atop",xor:"xor",add:"add",saturate:"saturate",multiply:"multiply",screen:"screen",overlay:"overlay",darken:"darken",lighten:"lighten","colour-dodge":"colour-dodge","color-dodge":"colour-dodge","colour-burn":"colour-burn","color-burn":"colour-burn","hard-light":"hard-light","soft-light":"soft-light",difference:"difference",exclusion:"exclusion"};function Uo(e){if(!Array.isArray(e))throw _.invalidParameterError("images to composite","array",e);return this.options.composite=e.map(t=>{if(!_.object(t))throw _.invalidParameterError("image to composite","object",t);let r=this._inputOptionsFromObject(t),i={input:this._createInputDescriptor(t.input,r,{allowStream:!1}),blend:"over",tile:!1,left:0,top:0,hasOffset:!1,gravity:0,premultiplied:!1};if(_.defined(t.blend))if(_.string(kt[t.blend]))i.blend=kt[t.blend];else throw _.invalidParameterError("blend","valid blend name",t.blend);if(_.defined(t.tile))if(_.bool(t.tile))i.tile=t.tile;else throw _.invalidParameterError("tile","boolean",t.tile);if(_.defined(t.left))if(_.integer(t.left))i.left=t.left;else throw _.invalidParameterError("left","integer",t.left);if(_.defined(t.top))if(_.integer(t.top))i.top=t.top;else throw _.invalidParameterError("top","integer",t.top);if(_.defined(t.top)!==_.defined(t.left))throw new Error("Expected both left and top to be set");if(i.hasOffset=_.integer(t.top)&&_.integer(t.left),_.defined(t.gravity))if(_.integer(t.gravity)&&_.inRange(t.gravity,0,8))i.gravity=t.gravity;else if(_.string(t.gravity)&&_.integer(this.constructor.gravity[t.gravity]))i.gravity=this.constructor.gravity[t.gravity];else throw _.invalidParameterError("gravity","valid gravity",t.gravity);if(_.defined(t.premultiplied))if(_.bool(t.premultiplied))i.premultiplied=t.premultiplied;else throw _.invalidParameterError("premultiplied","boolean",t.premultiplied);return i}),this}en.exports=function(e){e.prototype.composite=Uo,e.blend=kt}});var on=E(($c,an)=>{"use strict";var u=B(),rn={integer:"integer",float:"float",approximate:"approximate"};function Xo(e,t){if(!u.defined(e))return this.autoOrient();if((this.options.angle||this.options.rotationAngle)&&(this.options.debuglog("ignoring previous rotate options"),this.options.angle=0,this.options.rotationAngle=0),u.integer(e)&&!(e%90))this.options.angle=e;else if(u.number(e))this.options.rotationAngle=e,u.object(t)&&t.background&&this._setBackgroundColourOption("rotationBackground",t.background);else throw u.invalidParameterError("angle","numeric",e);return this}function Qo(){return this.options.input.autoOrient=!0,this}function Jo(e){return this.options.flip=u.bool(e)?e:!0,this}function Ko(e){return this.options.flop=u.bool(e)?e:!0,this}function Yo(e,t){let r=[].concat(...e);if(r.length===4&&r.every(u.number))this.options.affineMatrix=r;else throw u.invalidParameterError("matrix","1x4 or 2x2 array",e);if(u.defined(t))if(u.object(t)){if(this._setBackgroundColourOption("affineBackground",t.background),u.defined(t.idx))if(u.number(t.idx))this.options.affineIdx=t.idx;else throw u.invalidParameterError("options.idx","number",t.idx);if(u.defined(t.idy))if(u.number(t.idy))this.options.affineIdy=t.idy;else throw u.invalidParameterError("options.idy","number",t.idy);if(u.defined(t.odx))if(u.number(t.odx))this.options.affineOdx=t.odx;else throw u.invalidParameterError("options.odx","number",t.odx);if(u.defined(t.ody))if(u.number(t.ody))this.options.affineOdy=t.ody;else throw u.invalidParameterError("options.ody","number",t.ody);if(u.defined(t.interpolator))if(u.inArray(t.interpolator,Object.values(this.constructor.interpolators)))this.options.affineInterpolator=t.interpolator;else throw u.invalidParameterError("options.interpolator","valid interpolator name",t.interpolator)}else throw u.invalidParameterError("options","object",t);return this}function Zo(e,t,r){if(!u.defined(e))this.options.sharpenSigma=-1;else if(u.bool(e))this.options.sharpenSigma=e?-1:0;else if(u.number(e)&&u.inRange(e,.01,1e4)){if(this.options.sharpenSigma=e,u.defined(t))if(u.number(t)&&u.inRange(t,0,1e4))this.options.sharpenM1=t;else throw u.invalidParameterError("flat","number between 0 and 10000",t);if(u.defined(r))if(u.number(r)&&u.inRange(r,0,1e4))this.options.sharpenM2=r;else throw u.invalidParameterError("jagged","number between 0 and 10000",r)}else if(u.plainObject(e)){if(u.number(e.sigma)&&u.inRange(e.sigma,1e-6,10))this.options.sharpenSigma=e.sigma;else throw u.invalidParameterError("options.sigma","number between 0.000001 and 10",e.sigma);if(u.defined(e.m1))if(u.number(e.m1)&&u.inRange(e.m1,0,1e6))this.options.sharpenM1=e.m1;else throw u.invalidParameterError("options.m1","number between 0 and 1000000",e.m1);if(u.defined(e.m2))if(u.number(e.m2)&&u.inRange(e.m2,0,1e6))this.options.sharpenM2=e.m2;else throw u.invalidParameterError("options.m2","number between 0 and 1000000",e.m2);if(u.defined(e.x1))if(u.number(e.x1)&&u.inRange(e.x1,0,1e6))this.options.sharpenX1=e.x1;else throw u.invalidParameterError("options.x1","number between 0 and 1000000",e.x1);if(u.defined(e.y2))if(u.number(e.y2)&&u.inRange(e.y2,0,1e6))this.options.sharpenY2=e.y2;else throw u.invalidParameterError("options.y2","number between 0 and 1000000",e.y2);if(u.defined(e.y3))if(u.number(e.y3)&&u.inRange(e.y3,0,1e6))this.options.sharpenY3=e.y3;else throw u.invalidParameterError("options.y3","number between 0 and 1000000",e.y3)}else throw u.invalidParameterError("sigma","number between 0.01 and 10000",e);return this}function el(e){if(!u.defined(e))this.options.medianSize=3;else if(u.integer(e)&&u.inRange(e,1,1e3))this.options.medianSize=e;else throw u.invalidParameterError("size","integer between 1 and 1000",e);return this}function tl(e){let t;if(u.number(e))t=e;else if(u.plainObject(e)){if(!u.number(e.sigma))throw u.invalidParameterError("options.sigma","number between 0.3 and 1000",t);if(t=e.sigma,"precision"in e)if(u.string(rn[e.precision]))this.options.precision=rn[e.precision];else throw u.invalidParameterError("precision","one of: integer, float, approximate",e.precision);if("minAmplitude"in e)if(u.number(e.minAmplitude)&&u.inRange(e.minAmplitude,.001,1))this.options.minAmpl=e.minAmplitude;else throw u.invalidParameterError("minAmplitude","number between 0.001 and 1",e.minAmplitude)}if(!u.defined(e))this.options.blurSigma=-1;else if(u.bool(e))this.options.blurSigma=e?-1:0;else if(u.number(t)&&u.inRange(t,.3,1e3))this.options.blurSigma=t;else throw u.invalidParameterError("sigma","number between 0.3 and 1000",t);return this}function nn(e){if(!u.defined(e))this.options.dilateWidth=1;else if(u.integer(e)&&e>0)this.options.dilateWidth=e;else throw u.invalidParameterError("dilate","positive integer",nn);return this}function sn(e){if(!u.defined(e))this.options.erodeWidth=1;else if(u.integer(e)&&e>0)this.options.erodeWidth=e;else throw u.invalidParameterError("erode","positive integer",sn);return this}function rl(e){return this.options.flatten=u.bool(e)?e:!0,u.object(e)&&this._setBackgroundColourOption("flattenBackground",e.background),this}function il(){return this.options.unflatten=!0,this}function nl(e,t){if(!u.defined(e))this.options.gamma=2.2;else if(u.number(e)&&u.inRange(e,1,3))this.options.gamma=e;else throw u.invalidParameterError("gamma","number between 1.0 and 3.0",e);if(!u.defined(t))this.options.gammaOut=this.options.gamma;else if(u.number(t)&&u.inRange(t,1,3))this.options.gammaOut=t;else throw u.invalidParameterError("gammaOut","number between 1.0 and 3.0",t);return this}function sl(e){if(this.options.negate=u.bool(e)?e:!0,u.plainObject(e)&&"alpha"in e)if(u.bool(e.alpha))this.options.negateAlpha=e.alpha;else throw u.invalidParameterError("alpha","should be boolean value",e.alpha);return this}function al(e){if(u.plainObject(e)){if(u.defined(e.lower))if(u.number(e.lower)&&u.inRange(e.lower,0,99))this.options.normaliseLower=e.lower;else throw u.invalidParameterError("lower","number between 0 and 99",e.lower);if(u.defined(e.upper))if(u.number(e.upper)&&u.inRange(e.upper,1,100))this.options.normaliseUpper=e.upper;else throw u.invalidParameterError("upper","number between 1 and 100",e.upper)}if(this.options.normaliseLower>=this.options.normaliseUpper)throw u.invalidParameterError("range","lower to be less than upper",`${this.options.normaliseLower} >= ${this.options.normaliseUpper}`);return this.options.normalise=!0,this}function ol(e){return this.normalise(e)}function ll(e){if(u.plainObject(e)){if(u.integer(e.width)&&e.width>0)this.options.claheWidth=e.width;else throw u.invalidParameterError("width","integer greater than zero",e.width);if(u.integer(e.height)&&e.height>0)this.options.claheHeight=e.height;else throw u.invalidParameterError("height","integer greater than zero",e.height);if(u.defined(e.maxSlope))if(u.integer(e.maxSlope)&&u.inRange(e.maxSlope,0,100))this.options.claheMaxSlope=e.maxSlope;else throw u.invalidParameterError("maxSlope","integer between 0 and 100",e.maxSlope)}else throw u.invalidParameterError("options","plain object",e);return this}function hl(e){if(!u.object(e)||!Array.isArray(e.kernel)||!u.integer(e.width)||!u.integer(e.height)||!u.inRange(e.width,3,1001)||!u.inRange(e.height,3,1001)||e.height*e.width!==e.kernel.length)throw new Error("Invalid convolution kernel");return u.integer(e.scale)||(e.scale=e.kernel.reduce(function(t,r){return t+r},0)),e.scale<1&&(e.scale=1),u.integer(e.offset)||(e.offset=0),this.options.convKernel=e,this}function cl(e,t){if(!u.defined(e))this.options.threshold=128;else if(u.bool(e))this.options.threshold=e?128:0;else if(u.integer(e)&&u.inRange(e,0,255))this.options.threshold=e;else throw u.invalidParameterError("threshold","integer between 0 and 255",e);return!u.object(t)||t.greyscale===!0||t.grayscale===!0?this.options.thresholdGrayscale=!0:this.options.thresholdGrayscale=!1,this}function ul(e,t,r){if(this.options.boolean=this._createInputDescriptor(e,r),u.string(t)&&u.inArray(t,["and","or","eor"]))this.options.booleanOp=t;else throw u.invalidParameterError("operator","one of: and, or, eor",t);return this}function fl(e,t){if(!u.defined(e)&&u.number(t)?e=1:u.number(e)&&!u.defined(t)&&(t=0),!u.defined(e))this.options.linearA=[];else if(u.number(e))this.options.linearA=[e];else if(Array.isArray(e)&&e.length&&e.every(u.number))this.options.linearA=e;else throw u.invalidParameterError("a","number or array of numbers",e);if(!u.defined(t))this.options.linearB=[];else if(u.number(t))this.options.linearB=[t];else if(Array.isArray(t)&&t.length&&t.every(u.number))this.options.linearB=t;else throw u.invalidParameterError("b","number or array of numbers",t);if(this.options.linearA.length!==this.options.linearB.length)throw new Error("Expected a and b to be arrays of the same length");return this}function dl(e){if(!Array.isArray(e))throw u.invalidParameterError("inputMatrix","array",e);if(e.length!==3&&e.length!==4)throw u.invalidParameterError("inputMatrix","3x3 or 4x4 array",e.length);let t=e.flat().map(Number);if(t.length!==9&&t.length!==16)throw u.invalidParameterError("inputMatrix","cardinality of 9 or 16",t.length);return this.options.recombMatrix=t,this}function ml(e){if(!u.plainObject(e))throw u.invalidParameterError("options","plain object",e);if("brightness"in e)if(u.number(e.brightness)&&e.brightness>=0)this.options.brightness=e.brightness;else throw u.invalidParameterError("brightness","number above zero",e.brightness);if("saturation"in e)if(u.number(e.saturation)&&e.saturation>=0)this.options.saturation=e.saturation;else throw u.invalidParameterError("saturation","number above zero",e.saturation);if("hue"in e)if(u.integer(e.hue))this.options.hue=e.hue%360;else throw u.invalidParameterError("hue","number",e.hue);if("lightness"in e)if(u.number(e.lightness))this.options.lightness=e.lightness;else throw u.invalidParameterError("lightness","number",e.lightness);return this}an.exports=function(e){Object.assign(e.prototype,{autoOrient:Qo,rotate:Xo,flip:Jo,flop:Ko,affine:Yo,sharpen:Zo,erode:sn,dilate:nn,median:el,blur:tl,flatten:rl,unflatten:il,gamma:nl,negate:sl,normalise:al,normalize:ol,clahe:ll,convolve:hl,threshold:cl,boolean:ul,linear:fl,recomb:dl,modulate:ml})}});var jt=E((Sc,ln)=>{"use strict";ln.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}});var cn=E((Ic,hn)=>{hn.exports=function(t){return!t||typeof t=="string"?!1:t instanceof Array||Array.isArray(t)||t.length>=0&&(t.splice instanceof Function||Object.getOwnPropertyDescriptor(t,t.length-1)&&t.constructor.name!=="String")}});var dn=E((Oc,fn)=>{"use strict";var gl=cn(),pl=Array.prototype.concat,bl=Array.prototype.slice,un=fn.exports=function(t){for(var r=[],i=0,n=t.length;i<n;i++){var s=t[i];gl(s)?r=pl.call(r,bl.call(s)):r.push(s)}return r};un.wrap=function(e){return function(){return e(un(arguments))}}});var bn=E((Rc,pn)=>{var xe=jt(),_e=dn(),mn=Object.hasOwnProperty,gn=Object.create(null);for(Ge in xe)mn.call(xe,Ge)&&(gn[xe[Ge]]=Ge);var Ge,T=pn.exports={to:{},get:{}};T.get=function(e){var t=e.substring(0,3).toLowerCase(),r,i;switch(t){case"hsl":r=T.get.hsl(e),i="hsl";break;case"hwb":r=T.get.hwb(e),i="hwb";break;default:r=T.get.rgb(e),i="rgb";break}return r?{model:i,value:r}:null};T.get.rgb=function(e){if(!e)return null;var t=/^#([a-f0-9]{3,4})$/i,r=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,i=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,n=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,s=/^(\w+)$/,a=[0,0,0,1],l,c,f;if(l=e.match(r)){for(f=l[2],l=l[1],c=0;c<3;c++){var m=c*2;a[c]=parseInt(l.slice(m,m+2),16)}f&&(a[3]=parseInt(f,16)/255)}else if(l=e.match(t)){for(l=l[1],f=l[3],c=0;c<3;c++)a[c]=parseInt(l[c]+l[c],16);f&&(a[3]=parseInt(f+f,16)/255)}else if(l=e.match(i)){for(c=0;c<3;c++)a[c]=parseInt(l[c+1],0);l[4]&&(l[5]?a[3]=parseFloat(l[4])*.01:a[3]=parseFloat(l[4]))}else if(l=e.match(n)){for(c=0;c<3;c++)a[c]=Math.round(parseFloat(l[c+1])*2.55);l[4]&&(l[5]?a[3]=parseFloat(l[4])*.01:a[3]=parseFloat(l[4]))}else return(l=e.match(s))?l[1]==="transparent"?[0,0,0,0]:mn.call(xe,l[1])?(a=xe[l[1]],a[3]=1,a):null:null;for(c=0;c<3;c++)a[c]=ee(a[c],0,255);return a[3]=ee(a[3],0,1),a};T.get.hsl=function(e){if(!e)return null;var t=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,r=e.match(t);if(r){var i=parseFloat(r[4]),n=(parseFloat(r[1])%360+360)%360,s=ee(parseFloat(r[2]),0,100),a=ee(parseFloat(r[3]),0,100),l=ee(isNaN(i)?1:i,0,1);return[n,s,a,l]}return null};T.get.hwb=function(e){if(!e)return null;var t=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,r=e.match(t);if(r){var i=parseFloat(r[4]),n=(parseFloat(r[1])%360+360)%360,s=ee(parseFloat(r[2]),0,100),a=ee(parseFloat(r[3]),0,100),l=ee(isNaN(i)?1:i,0,1);return[n,s,a,l]}return null};T.to.hex=function(){var e=_e(arguments);return"#"+Ve(e[0])+Ve(e[1])+Ve(e[2])+(e[3]<1?Ve(Math.round(e[3]*255)):"")};T.to.rgb=function(){var e=_e(arguments);return e.length<4||e[3]===1?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"};T.to.rgb.percent=function(){var e=_e(arguments),t=Math.round(e[0]/255*100),r=Math.round(e[1]/255*100),i=Math.round(e[2]/255*100);return e.length<4||e[3]===1?"rgb("+t+"%, "+r+"%, "+i+"%)":"rgba("+t+"%, "+r+"%, "+i+"%, "+e[3]+")"};T.to.hsl=function(){var e=_e(arguments);return e.length<4||e[3]===1?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"};T.to.hwb=function(){var e=_e(arguments),t="";return e.length>=4&&e[3]!==1&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"};T.to.keyword=function(e){return gn[e.slice(0,3)]};function ee(e,t,r){return Math.min(Math.max(t,e),r)}function Ve(e){var t=Math.round(e).toString(16).toUpperCase();return t.length<2?"0"+t:t}});var Lt=E((kc,En)=>{var Ae=jt(),wn={};for(let e of Object.keys(Ae))wn[Ae[e]]=e;var b={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};En.exports=b;for(let e of Object.keys(b)){if(!("channels"in b[e]))throw new Error("missing channels property: "+e);if(!("labels"in b[e]))throw new Error("missing channel labels property: "+e);if(b[e].labels.length!==b[e].channels)throw new Error("channel and label counts mismatch: "+e);let{channels:t,labels:r}=b[e];delete b[e].channels,delete b[e].labels,Object.defineProperty(b[e],"channels",{value:t}),Object.defineProperty(b[e],"labels",{value:r})}b.rgb.hsl=function(e){let t=e[0]/255,r=e[1]/255,i=e[2]/255,n=Math.min(t,r,i),s=Math.max(t,r,i),a=s-n,l,c;s===n?l=0:t===s?l=(r-i)/a:r===s?l=2+(i-t)/a:i===s&&(l=4+(t-r)/a),l=Math.min(l*60,360),l<0&&(l+=360);let f=(n+s)/2;return s===n?c=0:f<=.5?c=a/(s+n):c=a/(2-s-n),[l,c*100,f*100]};b.rgb.hsv=function(e){let t,r,i,n,s,a=e[0]/255,l=e[1]/255,c=e[2]/255,f=Math.max(a,l,c),m=f-Math.min(a,l,c),d=function(x){return(f-x)/6/m+1/2};return m===0?(n=0,s=0):(s=m/f,t=d(a),r=d(l),i=d(c),a===f?n=i-r:l===f?n=1/3+t-i:c===f&&(n=2/3+r-t),n<0?n+=1:n>1&&(n-=1)),[n*360,s*100,f*100]};b.rgb.hwb=function(e){let t=e[0],r=e[1],i=e[2],n=b.rgb.hsl(e)[0],s=1/255*Math.min(t,Math.min(r,i));return i=1-1/255*Math.max(t,Math.max(r,i)),[n,s*100,i*100]};b.rgb.cmyk=function(e){let t=e[0]/255,r=e[1]/255,i=e[2]/255,n=Math.min(1-t,1-r,1-i),s=(1-t-n)/(1-n)||0,a=(1-r-n)/(1-n)||0,l=(1-i-n)/(1-n)||0;return[s*100,a*100,l*100,n*100]};function wl(e,t){return(e[0]-t[0])**2+(e[1]-t[1])**2+(e[2]-t[2])**2}b.rgb.keyword=function(e){let t=wn[e];if(t)return t;let r=1/0,i;for(let n of Object.keys(Ae)){let s=Ae[n],a=wl(e,s);a<r&&(r=a,i=n)}return i};b.keyword.rgb=function(e){return Ae[e]};b.rgb.xyz=function(e){let t=e[0]/255,r=e[1]/255,i=e[2]/255;t=t>.04045?((t+.055)/1.055)**2.4:t/12.92,r=r>.04045?((r+.055)/1.055)**2.4:r/12.92,i=i>.04045?((i+.055)/1.055)**2.4:i/12.92;let n=t*.4124+r*.3576+i*.1805,s=t*.2126+r*.7152+i*.0722,a=t*.0193+r*.1192+i*.9505;return[n*100,s*100,a*100]};b.rgb.lab=function(e){let t=b.rgb.xyz(e),r=t[0],i=t[1],n=t[2];r/=95.047,i/=100,n/=108.883,r=r>.008856?r**(1/3):7.787*r+16/116,i=i>.008856?i**(1/3):7.787*i+16/116,n=n>.008856?n**(1/3):7.787*n+16/116;let s=116*i-16,a=500*(r-i),l=200*(i-n);return[s,a,l]};b.hsl.rgb=function(e){let t=e[0]/360,r=e[1]/100,i=e[2]/100,n,s,a;if(r===0)return a=i*255,[a,a,a];i<.5?n=i*(1+r):n=i+r-i*r;let l=2*i-n,c=[0,0,0];for(let f=0;f<3;f++)s=t+1/3*-(f-1),s<0&&s++,s>1&&s--,6*s<1?a=l+(n-l)*6*s:2*s<1?a=n:3*s<2?a=l+(n-l)*(2/3-s)*6:a=l,c[f]=a*255;return c};b.hsl.hsv=function(e){let t=e[0],r=e[1]/100,i=e[2]/100,n=r,s=Math.max(i,.01);i*=2,r*=i<=1?i:2-i,n*=s<=1?s:2-s;let a=(i+r)/2,l=i===0?2*n/(s+n):2*r/(i+r);return[t,l*100,a*100]};b.hsv.rgb=function(e){let t=e[0]/60,r=e[1]/100,i=e[2]/100,n=Math.floor(t)%6,s=t-Math.floor(t),a=255*i*(1-r),l=255*i*(1-r*s),c=255*i*(1-r*(1-s));switch(i*=255,n){case 0:return[i,c,a];case 1:return[l,i,a];case 2:return[a,i,c];case 3:return[a,l,i];case 4:return[c,a,i];case 5:return[i,a,l]}};b.hsv.hsl=function(e){let t=e[0],r=e[1]/100,i=e[2]/100,n=Math.max(i,.01),s,a;a=(2-r)*i;let l=(2-r)*n;return s=r*n,s/=l<=1?l:2-l,s=s||0,a/=2,[t,s*100,a*100]};b.hwb.rgb=function(e){let t=e[0]/360,r=e[1]/100,i=e[2]/100,n=r+i,s;n>1&&(r/=n,i/=n);let a=Math.floor(6*t),l=1-i;s=6*t-a,(a&1)!==0&&(s=1-s);let c=r+s*(l-r),f,m,d;switch(a){default:case 6:case 0:f=l,m=c,d=r;break;case 1:f=c,m=l,d=r;break;case 2:f=r,m=l,d=c;break;case 3:f=r,m=c,d=l;break;case 4:f=c,m=r,d=l;break;case 5:f=l,m=r,d=c;break}return[f*255,m*255,d*255]};b.cmyk.rgb=function(e){let t=e[0]/100,r=e[1]/100,i=e[2]/100,n=e[3]/100,s=1-Math.min(1,t*(1-n)+n),a=1-Math.min(1,r*(1-n)+n),l=1-Math.min(1,i*(1-n)+n);return[s*255,a*255,l*255]};b.xyz.rgb=function(e){let t=e[0]/100,r=e[1]/100,i=e[2]/100,n,s,a;return n=t*3.2406+r*-1.5372+i*-.4986,s=t*-.9689+r*1.8758+i*.0415,a=t*.0557+r*-.204+i*1.057,n=n>.0031308?1.055*n**(1/2.4)-.055:n*12.92,s=s>.0031308?1.055*s**(1/2.4)-.055:s*12.92,a=a>.0031308?1.055*a**(1/2.4)-.055:a*12.92,n=Math.min(Math.max(0,n),1),s=Math.min(Math.max(0,s),1),a=Math.min(Math.max(0,a),1),[n*255,s*255,a*255]};b.xyz.lab=function(e){let t=e[0],r=e[1],i=e[2];t/=95.047,r/=100,i/=108.883,t=t>.008856?t**(1/3):7.787*t+16/116,r=r>.008856?r**(1/3):7.787*r+16/116,i=i>.008856?i**(1/3):7.787*i+16/116;let n=116*r-16,s=500*(t-r),a=200*(r-i);return[n,s,a]};b.lab.xyz=function(e){let t=e[0],r=e[1],i=e[2],n,s,a;s=(t+16)/116,n=r/500+s,a=s-i/200;let l=s**3,c=n**3,f=a**3;return s=l>.008856?l:(s-16/116)/7.787,n=c>.008856?c:(n-16/116)/7.787,a=f>.008856?f:(a-16/116)/7.787,n*=95.047,s*=100,a*=108.883,[n,s,a]};b.lab.lch=function(e){let t=e[0],r=e[1],i=e[2],n;n=Math.atan2(i,r)*360/2/Math.PI,n<0&&(n+=360);let a=Math.sqrt(r*r+i*i);return[t,a,n]};b.lch.lab=function(e){let t=e[0],r=e[1],n=e[2]/360*2*Math.PI,s=r*Math.cos(n),a=r*Math.sin(n);return[t,s,a]};b.rgb.ansi16=function(e,t=null){let[r,i,n]=e,s=t===null?b.rgb.hsv(e)[2]:t;if(s=Math.round(s/50),s===0)return 30;let a=30+(Math.round(n/255)<<2|Math.round(i/255)<<1|Math.round(r/255));return s===2&&(a+=60),a};b.hsv.ansi16=function(e){return b.rgb.ansi16(b.hsv.rgb(e),e[2])};b.rgb.ansi256=function(e){let t=e[0],r=e[1],i=e[2];return t===r&&r===i?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(r/255*5)+Math.round(i/255*5)};b.ansi16.rgb=function(e){let t=e%10;if(t===0||t===7)return e>50&&(t+=3.5),t=t/10.5*255,[t,t,t];let r=(~~(e>50)+1)*.5,i=(t&1)*r*255,n=(t>>1&1)*r*255,s=(t>>2&1)*r*255;return[i,n,s]};b.ansi256.rgb=function(e){if(e>=232){let s=(e-232)*10+8;return[s,s,s]}e-=16;let t,r=Math.floor(e/36)/5*255,i=Math.floor((t=e%36)/6)/5*255,n=t%6/5*255;return[r,i,n]};b.rgb.hex=function(e){let r=(((Math.round(e[0])&255)<<16)+((Math.round(e[1])&255)<<8)+(Math.round(e[2])&255)).toString(16).toUpperCase();return"000000".substring(r.length)+r};b.hex.rgb=function(e){let t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];let r=t[0];t[0].length===3&&(r=r.split("").map(l=>l+l).join(""));let i=parseInt(r,16),n=i>>16&255,s=i>>8&255,a=i&255;return[n,s,a]};b.rgb.hcg=function(e){let t=e[0]/255,r=e[1]/255,i=e[2]/255,n=Math.max(Math.max(t,r),i),s=Math.min(Math.min(t,r),i),a=n-s,l,c;return a<1?l=s/(1-a):l=0,a<=0?c=0:n===t?c=(r-i)/a%6:n===r?c=2+(i-t)/a:c=4+(t-r)/a,c/=6,c%=1,[c*360,a*100,l*100]};b.hsl.hcg=function(e){let t=e[1]/100,r=e[2]/100,i=r<.5?2*t*r:2*t*(1-r),n=0;return i<1&&(n=(r-.5*i)/(1-i)),[e[0],i*100,n*100]};b.hsv.hcg=function(e){let t=e[1]/100,r=e[2]/100,i=t*r,n=0;return i<1&&(n=(r-i)/(1-i)),[e[0],i*100,n*100]};b.hcg.rgb=function(e){let t=e[0]/360,r=e[1]/100,i=e[2]/100;if(r===0)return[i*255,i*255,i*255];let n=[0,0,0],s=t%1*6,a=s%1,l=1-a,c=0;switch(Math.floor(s)){case 0:n[0]=1,n[1]=a,n[2]=0;break;case 1:n[0]=l,n[1]=1,n[2]=0;break;case 2:n[0]=0,n[1]=1,n[2]=a;break;case 3:n[0]=0,n[1]=l,n[2]=1;break;case 4:n[0]=a,n[1]=0,n[2]=1;break;default:n[0]=1,n[1]=0,n[2]=l}return c=(1-r)*i,[(r*n[0]+c)*255,(r*n[1]+c)*255,(r*n[2]+c)*255]};b.hcg.hsv=function(e){let t=e[1]/100,r=e[2]/100,i=t+r*(1-t),n=0;return i>0&&(n=t/i),[e[0],n*100,i*100]};b.hcg.hsl=function(e){let t=e[1]/100,i=e[2]/100*(1-t)+.5*t,n=0;return i>0&&i<.5?n=t/(2*i):i>=.5&&i<1&&(n=t/(2*(1-i))),[e[0],n*100,i*100]};b.hcg.hwb=function(e){let t=e[1]/100,r=e[2]/100,i=t+r*(1-t);return[e[0],(i-t)*100,(1-i)*100]};b.hwb.hcg=function(e){let t=e[1]/100,i=1-e[2]/100,n=i-t,s=0;return n<1&&(s=(i-n)/(1-n)),[e[0],n*100,s*100]};b.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]};b.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]};b.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]};b.gray.hsl=function(e){return[0,0,e[0]]};b.gray.hsv=b.gray.hsl;b.gray.hwb=function(e){return[0,100,e[0]]};b.gray.cmyk=function(e){return[0,0,0,e[0]]};b.gray.lab=function(e){return[e[0],0,0]};b.gray.hex=function(e){let t=Math.round(e[0]/100*255)&255,i=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(i.length)+i};b.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}});var yn=E((jc,vn)=>{var ze=Lt();function El(){let e={},t=Object.keys(ze);for(let r=t.length,i=0;i<r;i++)e[t[i]]={distance:-1,parent:null};return e}function vl(e){let t=El(),r=[e];for(t[e].distance=0;r.length;){let i=r.pop(),n=Object.keys(ze[i]);for(let s=n.length,a=0;a<s;a++){let l=n[a],c=t[l];c.distance===-1&&(c.distance=t[i].distance+1,c.parent=i,r.unshift(l))}}return t}function yl(e,t){return function(r){return t(e(r))}}function xl(e,t){let r=[t[e].parent,e],i=ze[t[e].parent][e],n=t[e].parent;for(;t[n].parent;)r.unshift(t[n].parent),i=yl(ze[t[n].parent][n],i),n=t[n].parent;return i.conversion=r,i}vn.exports=function(e){let t=vl(e),r={},i=Object.keys(t);for(let n=i.length,s=0;s<n;s++){let a=i[s];t[a].parent!==null&&(r[a]=xl(a,t))}return r}});var _n=E((Lc,xn)=>{var Nt=Lt(),_l=yn(),fe={},Al=Object.keys(Nt);function Pl(e){let t=function(...r){let i=r[0];return i==null?i:(i.length>1&&(r=i),e(r))};return"conversion"in e&&(t.conversion=e.conversion),t}function Cl(e){let t=function(...r){let i=r[0];if(i==null)return i;i.length>1&&(r=i);let n=e(r);if(typeof n=="object")for(let s=n.length,a=0;a<s;a++)n[a]=Math.round(n[a]);return n};return"conversion"in e&&(t.conversion=e.conversion),t}Al.forEach(e=>{fe[e]={},Object.defineProperty(fe[e],"channels",{value:Nt[e].channels}),Object.defineProperty(fe[e],"labels",{value:Nt[e].labels});let t=_l(e);Object.keys(t).forEach(i=>{let n=t[i];fe[e][i]=Cl(n),fe[e][i].raw=Pl(n)})});xn.exports=fe});var Cn=E((Nc,Pn)=>{var de=bn(),F=_n(),An=["keyword","gray","hex"],Tt={};for(let e of Object.keys(F))Tt[[...F[e].labels].sort().join("")]=e;var Ue={};function O(e,t){if(!(this instanceof O))return new O(e,t);if(t&&t in An&&(t=null),t&&!(t in F))throw new Error("Unknown model: "+t);let r,i;if(e==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof O)this.model=e.model,this.color=[...e.color],this.valpha=e.valpha;else if(typeof e=="string"){let n=de.get(e);if(n===null)throw new Error("Unable to parse color from string: "+e);this.model=n.model,i=F[this.model].channels,this.color=n.value.slice(0,i),this.valpha=typeof n.value[i]=="number"?n.value[i]:1}else if(e.length>0){this.model=t||"rgb",i=F[this.model].channels;let n=Array.prototype.slice.call(e,0,i);this.color=Ft(n,i),this.valpha=typeof e[i]=="number"?e[i]:1}else if(typeof e=="number")this.model="rgb",this.color=[e>>16&255,e>>8&255,e&255],this.valpha=1;else{this.valpha=1;let n=Object.keys(e);"alpha"in e&&(n.splice(n.indexOf("alpha"),1),this.valpha=typeof e.alpha=="number"?e.alpha:0);let s=n.sort().join("");if(!(s in Tt))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=Tt[s];let{labels:a}=F[this.model],l=[];for(r=0;r<a.length;r++)l.push(e[a[r]]);this.color=Ft(l)}if(Ue[this.model])for(i=F[this.model].channels,r=0;r<i;r++){let n=Ue[this.model][r];n&&(this.color[r]=n(this.color[r]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}O.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(e){let t=this.model in de.to?this:this.rgb();t=t.round(typeof e=="number"?e:1);let r=t.valpha===1?t.color:[...t.color,this.valpha];return de.to[t.model](r)},percentString(e){let t=this.rgb().round(typeof e=="number"?e:1),r=t.valpha===1?t.color:[...t.color,this.valpha];return de.to.rgb.percent(r)},array(){return this.valpha===1?[...this.color]:[...this.color,this.valpha]},object(){let e={},{channels:t}=F[this.model],{labels:r}=F[this.model];for(let i=0;i<t;i++)e[r[i]]=this.color[i];return this.valpha!==1&&(e.alpha=this.valpha),e},unitArray(){let e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,this.valpha!==1&&e.push(this.valpha),e},unitObject(){let e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,this.valpha!==1&&(e.alpha=this.valpha),e},round(e){return e=Math.max(e||0,0),new O([...this.color.map(Sl(e)),this.valpha],this.model)},alpha(e){return e!==void 0?new O([...this.color,Math.max(0,Math.min(1,e))],this.model):this.valpha},red:C("rgb",0,S(255)),green:C("rgb",1,S(255)),blue:C("rgb",2,S(255)),hue:C(["hsl","hsv","hsl","hwb","hcg"],0,e=>(e%360+360)%360),saturationl:C("hsl",1,S(100)),lightness:C("hsl",2,S(100)),saturationv:C("hsv",1,S(100)),value:C("hsv",2,S(100)),chroma:C("hcg",1,S(100)),gray:C("hcg",2,S(100)),white:C("hwb",1,S(100)),wblack:C("hwb",2,S(100)),cyan:C("cmyk",0,S(100)),magenta:C("cmyk",1,S(100)),yellow:C("cmyk",2,S(100)),black:C("cmyk",3,S(100)),x:C("xyz",0,S(95.047)),y:C("xyz",1,S(100)),z:C("xyz",2,S(108.833)),l:C("lab",0,S(100)),a:C("lab",1),b:C("lab",2),keyword(e){return e!==void 0?new O(e):F[this.model].keyword(this.color)},hex(e){return e!==void 0?new O(e):de.to.hex(this.rgb().round().color)},hexa(e){if(e!==void 0)return new O(e);let t=this.rgb().round().color,r=Math.round(this.valpha*255).toString(16).toUpperCase();return r.length===1&&(r="0"+r),de.to.hex(t)+r},rgbNumber(){let e=this.rgb().color;return(e[0]&255)<<16|(e[1]&255)<<8|e[2]&255},luminosity(){let e=this.rgb().color,t=[];for(let[r,i]of e.entries()){let n=i/255;t[r]=n<=.04045?n/12.92:((n+.055)/1.055)**2.4}return .2126*t[0]+.7152*t[1]+.0722*t[2]},contrast(e){let t=this.luminosity(),r=e.luminosity();return t>r?(t+.05)/(r+.05):(r+.05)/(t+.05)},level(e){let t=this.contrast(e);return t>=7?"AAA":t>=4.5?"AA":""},isDark(){let e=this.rgb().color;return(e[0]*2126+e[1]*7152+e[2]*722)/1e4<128},isLight(){return!this.isDark()},negate(){let e=this.rgb();for(let t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten(e){let t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken(e){let t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate(e){let t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate(e){let t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten(e){let t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken(e){let t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale(){let e=this.rgb().color,t=e[0]*.3+e[1]*.59+e[2]*.11;return O.rgb(t,t,t)},fade(e){return this.alpha(this.valpha-this.valpha*e)},opaquer(e){return this.alpha(this.valpha+this.valpha*e)},rotate(e){let t=this.hsl(),r=t.color[0];return r=(r+e)%360,r=r<0?360+r:r,t.color[0]=r,t},mix(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);let r=e.rgb(),i=this.rgb(),n=t===void 0?.5:t,s=2*n-1,a=r.alpha()-i.alpha(),l=((s*a===-1?s:(s+a)/(1+s*a))+1)/2,c=1-l;return O.rgb(l*r.red()+c*i.red(),l*r.green()+c*i.green(),l*r.blue()+c*i.blue(),r.alpha()*n+i.alpha()*(1-n))}};for(let e of Object.keys(F)){if(An.includes(e))continue;let{channels:t}=F[e];O.prototype[e]=function(...r){return this.model===e?new O(this):r.length>0?new O(r,e):new O([...Il(F[this.model][e].raw(this.color)),this.valpha],e)},O[e]=function(...r){let i=r[0];return typeof i=="number"&&(i=Ft(r,t)),new O(i,e)}}function $l(e,t){return Number(e.toFixed(t))}function Sl(e){return function(t){return $l(t,e)}}function C(e,t,r){e=Array.isArray(e)?e:[e];for(let i of e)(Ue[i]||(Ue[i]=[]))[t]=r;return e=e[0],function(i){let n;return i!==void 0?(r&&(i=r(i)),n=this[e](),n.color[t]=i,n):(n=this[e]().color[t],r&&(n=r(n)),n)}}function S(e){return function(t){return Math.max(0,Math.min(e,t))}}function Il(e){return Array.isArray(e)?e:[e]}function Ft(e,t){for(let r=0;r<t;r++)typeof e[r]!="number"&&(e[r]=0);return e}Pn.exports=O});var On=E((Tc,In)=>{"use strict";var Ol=Cn(),Q=B(),$n={multiband:"multiband","b-w":"b-w",bw:"b-w",cmyk:"cmyk",srgb:"srgb"};function Rl(e){return this._setBackgroundColourOption("tint",e),this}function kl(e){return this.options.greyscale=Q.bool(e)?e:!0,this}function jl(e){return this.greyscale(e)}function Ll(e){if(!Q.string(e))throw Q.invalidParameterError("colourspace","string",e);return this.options.colourspacePipeline=e,this}function Nl(e){return this.pipelineColourspace(e)}function Tl(e){if(!Q.string(e))throw Q.invalidParameterError("colourspace","string",e);return this.options.colourspace=e,this}function Fl(e){return this.toColourspace(e)}function Sn(e){if(Q.object(e)||Q.string(e)){let t=Ol(e);return[t.red(),t.green(),t.blue(),Math.round(t.alpha()*255)]}else throw Q.invalidParameterError("background","object or string",e)}function ql(e,t){Q.defined(t)&&(this.options[e]=Sn(t))}In.exports=function(e){Object.assign(e.prototype,{tint:Rl,greyscale:kl,grayscale:jl,pipelineColourspace:Ll,pipelineColorspace:Nl,toColourspace:Tl,toColorspace:Fl,_getBackgroundColourOption:Sn,_setBackgroundColourOption:ql}),e.colourspace=$n,e.colorspace=$n}});var kn=E((Fc,Rn)=>{"use strict";var z=B(),Dl={and:"and",or:"or",eor:"eor"};function Ml(){return this.options.removeAlpha=!0,this}function Hl(e){if(z.defined(e))if(z.number(e)&&z.inRange(e,0,1))this.options.ensureAlpha=e;else throw z.invalidParameterError("alpha","number between 0 and 1",e);else this.options.ensureAlpha=1;return this}function Bl(e){let t={red:0,green:1,blue:2,alpha:3};if(Object.keys(t).includes(e)&&(e=t[e]),z.integer(e)&&z.inRange(e,0,4))this.options.extractChannel=e;else throw z.invalidParameterError("channel","integer or one of: red, green, blue, alpha",e);return this}function Wl(e,t){return Array.isArray(e)?e.forEach(function(r){this.options.joinChannelIn.push(this._createInputDescriptor(r,t))},this):this.options.joinChannelIn.push(this._createInputDescriptor(e,t)),this}function Gl(e){if(z.string(e)&&z.inArray(e,["and","or","eor"]))this.options.bandBoolOp=e;else throw z.invalidParameterError("boolOp","one of: and, or, eor",e);return this}Rn.exports=function(e){Object.assign(e.prototype,{removeAlpha:Ml,ensureAlpha:Hl,extractChannel:Bl,joinChannel:Wl,bandbool:Gl}),e.bool=Dl}});var Fn=E((qc,Tn)=>{"use strict";var qt=require("node:path"),o=B(),me=ye(),jn=new Map([["heic","heif"],["heif","heif"],["avif","avif"],["jpeg","jpeg"],["jpg","jpeg"],["jpe","jpeg"],["tile","tile"],["dz","tile"],["png","png"],["raw","raw"],["tiff","tiff"],["tif","tiff"],["webp","webp"],["gif","gif"],["jp2","jp2"],["jpx","jp2"],["j2k","jp2"],["j2c","jp2"],["jxl","jxl"]]),Vl=/\.(jp[2x]|j2[kc])$/i,Ln=()=>new Error("JP2 output requires libvips with support for OpenJPEG"),Nn=e=>1<<31-Math.clz32(Math.ceil(Math.log2(e)));function zl(e,t){let r;if(o.string(e)?o.string(this.options.input.file)&&qt.resolve(this.options.input.file)===qt.resolve(e)?r=new Error("Cannot use same file for input and output"):Vl.test(qt.extname(e))&&!this.constructor.format.jp2k.output.file&&(r=Ln()):r=new Error("Missing output file path"),r)if(o.fn(t))t(r);else return Promise.reject(r);else{this.options.fileOut=e;let i=Error();return this._pipeline(t,i)}return this}function Ul(e,t){o.object(e)?this._setBooleanOption("resolveWithObject",e.resolveWithObject):this.options.resolveWithObject&&(this.options.resolveWithObject=!1),this.options.fileOut="";let r=Error();return this._pipeline(o.fn(e)?e:t,r)}function Xl(){return this.options.keepMetadata|=1,this}function Ql(e){if(o.object(e))for(let[t,r]of Object.entries(e))if(o.object(r))for(let[i,n]of Object.entries(r))if(o.string(n))this.options.withExif[`exif-${t.toLowerCase()}-${i}`]=n;else throw o.invalidParameterError(`${t}.${i}`,"string",n);else throw o.invalidParameterError(t,"object",r);else throw o.invalidParameterError("exif","object",e);return this.options.withExifMerge=!1,this.keepExif()}function Jl(e){return this.withExif(e),this.options.withExifMerge=!0,this}function Kl(){return this.options.keepMetadata|=8,this}function Yl(e,t){if(o.string(e))this.options.withIccProfile=e;else throw o.invalidParameterError("icc","string",e);if(this.keepIccProfile(),o.object(t)&&o.defined(t.attach))if(o.bool(t.attach))t.attach||(this.options.keepMetadata&=-9);else throw o.invalidParameterError("attach","boolean",t.attach);return this}function Zl(){return this.options.keepMetadata|=2,this}function eh(e){if(o.string(e)&&e.length>0)this.options.withXmp=e,this.options.keepMetadata|=2;else throw o.invalidParameterError("xmp","non-empty string",e);return this}function th(){return this.options.keepMetadata=31,this}function rh(e){if(this.keepMetadata(),this.withIccProfile("srgb"),o.object(e)){if(o.defined(e.orientation))if(o.integer(e.orientation)&&o.inRange(e.orientation,1,8))this.options.withMetadataOrientation=e.orientation;else throw o.invalidParameterError("orientation","integer between 1 and 8",e.orientation);if(o.defined(e.density))if(o.number(e.density)&&e.density>0)this.options.withMetadataDensity=e.density;else throw o.invalidParameterError("density","positive number",e.density);o.defined(e.icc)&&this.withIccProfile(e.icc),o.defined(e.exif)&&this.withExifMerge(e.exif)}return this}function ih(e,t){let r=jn.get((o.object(e)&&o.string(e.id)?e.id:e).toLowerCase());if(!r)throw o.invalidParameterError("format",`one of: ${[...jn.keys()].join(", ")}`,e);return this[r](t)}function nh(e){if(o.object(e)){if(o.defined(e.quality))if(o.integer(e.quality)&&o.inRange(e.quality,1,100))this.options.jpegQuality=e.quality;else throw o.invalidParameterError("quality","integer between 1 and 100",e.quality);if(o.defined(e.progressive)&&this._setBooleanOption("jpegProgressive",e.progressive),o.defined(e.chromaSubsampling))if(o.string(e.chromaSubsampling)&&o.inArray(e.chromaSubsampling,["4:2:0","4:4:4"]))this.options.jpegChromaSubsampling=e.chromaSubsampling;else throw o.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",e.chromaSubsampling);let t=o.bool(e.optimizeCoding)?e.optimizeCoding:e.optimiseCoding;if(o.defined(t)&&this._setBooleanOption("jpegOptimiseCoding",t),o.defined(e.mozjpeg))if(o.bool(e.mozjpeg))e.mozjpeg&&(this.options.jpegTrellisQuantisation=!0,this.options.jpegOvershootDeringing=!0,this.options.jpegOptimiseScans=!0,this.options.jpegProgressive=!0,this.options.jpegQuantisationTable=3);else throw o.invalidParameterError("mozjpeg","boolean",e.mozjpeg);let r=o.bool(e.trellisQuantization)?e.trellisQuantization:e.trellisQuantisation;o.defined(r)&&this._setBooleanOption("jpegTrellisQuantisation",r),o.defined(e.overshootDeringing)&&this._setBooleanOption("jpegOvershootDeringing",e.overshootDeringing);let i=o.bool(e.optimizeScans)?e.optimizeScans:e.optimiseScans;o.defined(i)&&(this._setBooleanOption("jpegOptimiseScans",i),i&&(this.options.jpegProgressive=!0));let n=o.number(e.quantizationTable)?e.quantizationTable:e.quantisationTable;if(o.defined(n))if(o.integer(n)&&o.inRange(n,0,8))this.options.jpegQuantisationTable=n;else throw o.invalidParameterError("quantisationTable","integer between 0 and 8",n)}return this._updateFormatOut("jpeg",e)}function sh(e){if(o.object(e)){if(o.defined(e.progressive)&&this._setBooleanOption("pngProgressive",e.progressive),o.defined(e.compressionLevel))if(o.integer(e.compressionLevel)&&o.inRange(e.compressionLevel,0,9))this.options.pngCompressionLevel=e.compressionLevel;else throw o.invalidParameterError("compressionLevel","integer between 0 and 9",e.compressionLevel);o.defined(e.adaptiveFiltering)&&this._setBooleanOption("pngAdaptiveFiltering",e.adaptiveFiltering);let t=e.colours||e.colors;if(o.defined(t))if(o.integer(t)&&o.inRange(t,2,256))this.options.pngBitdepth=Nn(t);else throw o.invalidParameterError("colours","integer between 2 and 256",t);if(o.defined(e.palette)?this._setBooleanOption("pngPalette",e.palette):[e.quality,e.effort,e.colours,e.colors,e.dither].some(o.defined)&&this._setBooleanOption("pngPalette",!0),this.options.pngPalette){if(o.defined(e.quality))if(o.integer(e.quality)&&o.inRange(e.quality,0,100))this.options.pngQuality=e.quality;else throw o.invalidParameterError("quality","integer between 0 and 100",e.quality);if(o.defined(e.effort))if(o.integer(e.effort)&&o.inRange(e.effort,1,10))this.options.pngEffort=e.effort;else throw o.invalidParameterError("effort","integer between 1 and 10",e.effort);if(o.defined(e.dither))if(o.number(e.dither)&&o.inRange(e.dither,0,1))this.options.pngDither=e.dither;else throw o.invalidParameterError("dither","number between 0.0 and 1.0",e.dither)}}return this._updateFormatOut("png",e)}function ah(e){if(o.object(e)){if(o.defined(e.quality))if(o.integer(e.quality)&&o.inRange(e.quality,1,100))this.options.webpQuality=e.quality;else throw o.invalidParameterError("quality","integer between 1 and 100",e.quality);if(o.defined(e.alphaQuality))if(o.integer(e.alphaQuality)&&o.inRange(e.alphaQuality,0,100))this.options.webpAlphaQuality=e.alphaQuality;else throw o.invalidParameterError("alphaQuality","integer between 0 and 100",e.alphaQuality);if(o.defined(e.lossless)&&this._setBooleanOption("webpLossless",e.lossless),o.defined(e.nearLossless)&&this._setBooleanOption("webpNearLossless",e.nearLossless),o.defined(e.smartSubsample)&&this._setBooleanOption("webpSmartSubsample",e.smartSubsample),o.defined(e.smartDeblock)&&this._setBooleanOption("webpSmartDeblock",e.smartDeblock),o.defined(e.preset))if(o.string(e.preset)&&o.inArray(e.preset,["default","photo","picture","drawing","icon","text"]))this.options.webpPreset=e.preset;else throw o.invalidParameterError("preset","one of: default, photo, picture, drawing, icon, text",e.preset);if(o.defined(e.effort))if(o.integer(e.effort)&&o.inRange(e.effort,0,6))this.options.webpEffort=e.effort;else throw o.invalidParameterError("effort","integer between 0 and 6",e.effort);o.defined(e.minSize)&&this._setBooleanOption("webpMinSize",e.minSize),o.defined(e.mixed)&&this._setBooleanOption("webpMixed",e.mixed)}return Dt(e,this.options),this._updateFormatOut("webp",e)}function oh(e){if(o.object(e)){o.defined(e.reuse)&&this._setBooleanOption("gifReuse",e.reuse),o.defined(e.progressive)&&this._setBooleanOption("gifProgressive",e.progressive);let t=e.colours||e.colors;if(o.defined(t))if(o.integer(t)&&o.inRange(t,2,256))this.options.gifBitdepth=Nn(t);else throw o.invalidParameterError("colours","integer between 2 and 256",t);if(o.defined(e.effort))if(o.number(e.effort)&&o.inRange(e.effort,1,10))this.options.gifEffort=e.effort;else throw o.invalidParameterError("effort","integer between 1 and 10",e.effort);if(o.defined(e.dither))if(o.number(e.dither)&&o.inRange(e.dither,0,1))this.options.gifDither=e.dither;else throw o.invalidParameterError("dither","number between 0.0 and 1.0",e.dither);if(o.defined(e.interFrameMaxError))if(o.number(e.interFrameMaxError)&&o.inRange(e.interFrameMaxError,0,32))this.options.gifInterFrameMaxError=e.interFrameMaxError;else throw o.invalidParameterError("interFrameMaxError","number between 0.0 and 32.0",e.interFrameMaxError);if(o.defined(e.interPaletteMaxError))if(o.number(e.interPaletteMaxError)&&o.inRange(e.interPaletteMaxError,0,256))this.options.gifInterPaletteMaxError=e.interPaletteMaxError;else throw o.invalidParameterError("interPaletteMaxError","number between 0.0 and 256.0",e.interPaletteMaxError);if(o.defined(e.keepDuplicateFrames))if(o.bool(e.keepDuplicateFrames))this._setBooleanOption("gifKeepDuplicateFrames",e.keepDuplicateFrames);else throw o.invalidParameterError("keepDuplicateFrames","boolean",e.keepDuplicateFrames)}return Dt(e,this.options),this._updateFormatOut("gif",e)}function lh(e){if(!this.constructor.format.jp2k.output.buffer)throw Ln();if(o.object(e)){if(o.defined(e.quality))if(o.integer(e.quality)&&o.inRange(e.quality,1,100))this.options.jp2Quality=e.quality;else throw o.invalidParameterError("quality","integer between 1 and 100",e.quality);if(o.defined(e.lossless))if(o.bool(e.lossless))this.options.jp2Lossless=e.lossless;else throw o.invalidParameterError("lossless","boolean",e.lossless);if(o.defined(e.tileWidth))if(o.integer(e.tileWidth)&&o.inRange(e.tileWidth,1,32768))this.options.jp2TileWidth=e.tileWidth;else throw o.invalidParameterError("tileWidth","integer between 1 and 32768",e.tileWidth);if(o.defined(e.tileHeight))if(o.integer(e.tileHeight)&&o.inRange(e.tileHeight,1,32768))this.options.jp2TileHeight=e.tileHeight;else throw o.invalidParameterError("tileHeight","integer between 1 and 32768",e.tileHeight);if(o.defined(e.chromaSubsampling))if(o.string(e.chromaSubsampling)&&o.inArray(e.chromaSubsampling,["4:2:0","4:4:4"]))this.options.jp2ChromaSubsampling=e.chromaSubsampling;else throw o.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",e.chromaSubsampling)}return this._updateFormatOut("jp2",e)}function Dt(e,t){if(o.object(e)&&o.defined(e.loop))if(o.integer(e.loop)&&o.inRange(e.loop,0,65535))t.loop=e.loop;else throw o.invalidParameterError("loop","integer between 0 and 65535",e.loop);if(o.object(e)&&o.defined(e.delay))if(o.integer(e.delay)&&o.inRange(e.delay,0,65535))t.delay=[e.delay];else if(Array.isArray(e.delay)&&e.delay.every(o.integer)&&e.delay.every(r=>o.inRange(r,0,65535)))t.delay=e.delay;else throw o.invalidParameterError("delay","integer or an array of integers between 0 and 65535",e.delay)}function hh(e){if(o.object(e)){if(o.defined(e.quality))if(o.integer(e.quality)&&o.inRange(e.quality,1,100))this.options.tiffQuality=e.quality;else throw o.invalidParameterError("quality","integer between 1 and 100",e.quality);if(o.defined(e.bitdepth))if(o.integer(e.bitdepth)&&o.inArray(e.bitdepth,[1,2,4,8]))this.options.tiffBitdepth=e.bitdepth;else throw o.invalidParameterError("bitdepth","1, 2, 4 or 8",e.bitdepth);if(o.defined(e.tile)&&this._setBooleanOption("tiffTile",e.tile),o.defined(e.tileWidth))if(o.integer(e.tileWidth)&&e.tileWidth>0)this.options.tiffTileWidth=e.tileWidth;else throw o.invalidParameterError("tileWidth","integer greater than zero",e.tileWidth);if(o.defined(e.tileHeight))if(o.integer(e.tileHeight)&&e.tileHeight>0)this.options.tiffTileHeight=e.tileHeight;else throw o.invalidParameterError("tileHeight","integer greater than zero",e.tileHeight);if(o.defined(e.miniswhite)&&this._setBooleanOption("tiffMiniswhite",e.miniswhite),o.defined(e.pyramid)&&this._setBooleanOption("tiffPyramid",e.pyramid),o.defined(e.xres))if(o.number(e.xres)&&e.xres>0)this.options.tiffXres=e.xres;else throw o.invalidParameterError("xres","number greater than zero",e.xres);if(o.defined(e.yres))if(o.number(e.yres)&&e.yres>0)this.options.tiffYres=e.yres;else throw o.invalidParameterError("yres","number greater than zero",e.yres);if(o.defined(e.compression))if(o.string(e.compression)&&o.inArray(e.compression,["none","jpeg","deflate","packbits","ccittfax4","lzw","webp","zstd","jp2k"]))this.options.tiffCompression=e.compression;else throw o.invalidParameterError("compression","one of: none, jpeg, deflate, packbits, ccittfax4, lzw, webp, zstd, jp2k",e.compression);if(o.defined(e.predictor))if(o.string(e.predictor)&&o.inArray(e.predictor,["none","horizontal","float"]))this.options.tiffPredictor=e.predictor;else throw o.invalidParameterError("predictor","one of: none, horizontal, float",e.predictor);if(o.defined(e.resolutionUnit))if(o.string(e.resolutionUnit)&&o.inArray(e.resolutionUnit,["inch","cm"]))this.options.tiffResolutionUnit=e.resolutionUnit;else throw o.invalidParameterError("resolutionUnit","one of: inch, cm",e.resolutionUnit)}return this._updateFormatOut("tiff",e)}function ch(e){return this.heif({...e,compression:"av1"})}function uh(e){if(o.object(e)){if(o.string(e.compression)&&o.inArray(e.compression,["av1","hevc"]))this.options.heifCompression=e.compression;else throw o.invalidParameterError("compression","one of: av1, hevc",e.compression);if(o.defined(e.quality))if(o.integer(e.quality)&&o.inRange(e.quality,1,100))this.options.heifQuality=e.quality;else throw o.invalidParameterError("quality","integer between 1 and 100",e.quality);if(o.defined(e.lossless))if(o.bool(e.lossless))this.options.heifLossless=e.lossless;else throw o.invalidParameterError("lossless","boolean",e.lossless);if(o.defined(e.effort))if(o.integer(e.effort)&&o.inRange(e.effort,0,9))this.options.heifEffort=e.effort;else throw o.invalidParameterError("effort","integer between 0 and 9",e.effort);if(o.defined(e.chromaSubsampling))if(o.string(e.chromaSubsampling)&&o.inArray(e.chromaSubsampling,["4:2:0","4:4:4"]))this.options.heifChromaSubsampling=e.chromaSubsampling;else throw o.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",e.chromaSubsampling);if(o.defined(e.bitdepth))if(o.integer(e.bitdepth)&&o.inArray(e.bitdepth,[8,10,12])){if(e.bitdepth!==8&&this.constructor.versions.heif)throw o.invalidParameterError("bitdepth when using prebuilt binaries",8,e.bitdepth);this.options.heifBitdepth=e.bitdepth}else throw o.invalidParameterError("bitdepth","8, 10 or 12",e.bitdepth)}else throw o.invalidParameterError("options","Object",e);return this._updateFormatOut("heif",e)}function fh(e){if(o.object(e)){if(o.defined(e.quality))if(o.integer(e.quality)&&o.inRange(e.quality,1,100))this.options.jxlDistance=e.quality>=30?.1+(100-e.quality)*.09:53/3e3*e.quality*e.quality-23/20*e.quality+25;else throw o.invalidParameterError("quality","integer between 1 and 100",e.quality);else if(o.defined(e.distance))if(o.number(e.distance)&&o.inRange(e.distance,0,15))this.options.jxlDistance=e.distance;else throw o.invalidParameterError("distance","number between 0.0 and 15.0",e.distance);if(o.defined(e.decodingTier))if(o.integer(e.decodingTier)&&o.inRange(e.decodingTier,0,4))this.options.jxlDecodingTier=e.decodingTier;else throw o.invalidParameterError("decodingTier","integer between 0 and 4",e.decodingTier);if(o.defined(e.lossless))if(o.bool(e.lossless))this.options.jxlLossless=e.lossless;else throw o.invalidParameterError("lossless","boolean",e.lossless);if(o.defined(e.effort))if(o.integer(e.effort)&&o.inRange(e.effort,1,9))this.options.jxlEffort=e.effort;else throw o.invalidParameterError("effort","integer between 1 and 9",e.effort)}return Dt(e,this.options),this._updateFormatOut("jxl",e)}function dh(e){if(o.object(e)&&o.defined(e.depth))if(o.string(e.depth)&&o.inArray(e.depth,["char","uchar","short","ushort","int","uint","float","complex","double","dpcomplex"]))this.options.rawDepth=e.depth;else throw o.invalidParameterError("depth","one of: char, uchar, short, ushort, int, uint, float, complex, double, dpcomplex",e.depth);return this._updateFormatOut("raw")}function mh(e){if(o.object(e)){if(o.defined(e.size))if(o.integer(e.size)&&o.inRange(e.size,1,8192))this.options.tileSize=e.size;else throw o.invalidParameterError("size","integer between 1 and 8192",e.size);if(o.defined(e.overlap))if(o.integer(e.overlap)&&o.inRange(e.overlap,0,8192)){if(e.overlap>this.options.tileSize)throw o.invalidParameterError("overlap",`<= size (${this.options.tileSize})`,e.overlap);this.options.tileOverlap=e.overlap}else throw o.invalidParameterError("overlap","integer between 0 and 8192",e.overlap);if(o.defined(e.container))if(o.string(e.container)&&o.inArray(e.container,["fs","zip"]))this.options.tileContainer=e.container;else throw o.invalidParameterError("container","one of: fs, zip",e.container);if(o.defined(e.layout))if(o.string(e.layout)&&o.inArray(e.layout,["dz","google","iiif","iiif3","zoomify"]))this.options.tileLayout=e.layout;else throw o.invalidParameterError("layout","one of: dz, google, iiif, iiif3, zoomify",e.layout);if(o.defined(e.angle))if(o.integer(e.angle)&&!(e.angle%90))this.options.tileAngle=e.angle;else throw o.invalidParameterError("angle","positive/negative multiple of 90",e.angle);if(this._setBackgroundColourOption("tileBackground",e.background),o.defined(e.depth))if(o.string(e.depth)&&o.inArray(e.depth,["onepixel","onetile","one"]))this.options.tileDepth=e.depth;else throw o.invalidParameterError("depth","one of: onepixel, onetile, one",e.depth);if(o.defined(e.skipBlanks))if(o.integer(e.skipBlanks)&&o.inRange(e.skipBlanks,-1,65535))this.options.tileSkipBlanks=e.skipBlanks;else throw o.invalidParameterError("skipBlanks","integer between -1 and 255/65535",e.skipBlanks);else o.defined(e.layout)&&e.layout==="google"&&(this.options.tileSkipBlanks=5);let t=o.bool(e.center)?e.center:e.centre;if(o.defined(t)&&this._setBooleanOption("tileCentre",t),o.defined(e.id))if(o.string(e.id))this.options.tileId=e.id;else throw o.invalidParameterError("id","string",e.id);if(o.defined(e.basename))if(o.string(e.basename))this.options.tileBasename=e.basename;else throw o.invalidParameterError("basename","string",e.basename)}if(o.inArray(this.options.formatOut,["jpeg","png","webp"]))this.options.tileFormat=this.options.formatOut;else if(this.options.formatOut!=="input")throw o.invalidParameterError("format","one of: jpeg, png, webp",this.options.formatOut);return this._updateFormatOut("dz")}function gh(e){if(!o.plainObject(e))throw o.invalidParameterError("options","object",e);if(o.integer(e.seconds)&&o.inRange(e.seconds,0,3600))this.options.timeoutSeconds=e.seconds;else throw o.invalidParameterError("seconds","integer between 0 and 3600",e.seconds);return this}function ph(e,t){return o.object(t)&&t.force===!1||(this.options.formatOut=e),this}function bh(e,t){if(o.bool(t))this.options[e]=t;else throw o.invalidParameterError(e,"boolean",t)}function wh(){if(!this.options.streamOut){this.options.streamOut=!0;let e=Error();this._pipeline(void 0,e)}}function Eh(e,t){return typeof e=="function"?(this._isStreamInput()?this.on("finish",()=>{this._flattenBufferIn(),me.pipeline(this.options,(r,i,n)=>{r?e(o.nativeError(r,t)):e(null,i,n)})}):me.pipeline(this.options,(r,i,n)=>{r?e(o.nativeError(r,t)):e(null,i,n)}),this):this.options.streamOut?(this._isStreamInput()?(this.once("finish",()=>{this._flattenBufferIn(),me.pipeline(this.options,(r,i,n)=>{r?this.emit("error",o.nativeError(r,t)):(this.emit("info",n),this.push(i)),this.push(null),this.on("end",()=>this.emit("close"))})}),this.streamInFinished&&this.emit("finish")):me.pipeline(this.options,(r,i,n)=>{r?this.emit("error",o.nativeError(r,t)):(this.emit("info",n),this.push(i)),this.push(null),this.on("end",()=>this.emit("close"))}),this):this._isStreamInput()?new Promise((r,i)=>{this.once("finish",()=>{this._flattenBufferIn(),me.pipeline(this.options,(n,s,a)=>{n?i(o.nativeError(n,t)):this.options.resolveWithObject?r({data:s,info:a}):r(s)})})}):new Promise((r,i)=>{me.pipeline(this.options,(n,s,a)=>{n?i(o.nativeError(n,t)):this.options.resolveWithObject?r({data:s,info:a}):r(s)})})}Tn.exports=function(e){Object.assign(e.prototype,{toFile:zl,toBuffer:Ul,keepExif:Xl,withExif:Ql,withExifMerge:Jl,keepIccProfile:Kl,withIccProfile:Yl,keepXmp:Zl,withXmp:eh,keepMetadata:th,withMetadata:rh,toFormat:ih,jpeg:nh,jp2:lh,png:sh,webp:ah,tiff:hh,avif:ch,heif:uh,jxl:fh,gif:oh,raw:dh,tile:mh,timeout:gh,_updateFormatOut:ph,_setBooleanOption:bh,_read:wh,_pipeline:Eh})}});var Hn=E((Dc,Mn)=>{"use strict";var vh=require("node:events"),Xe=ke(),D=B(),{runtimePlatformArch:yh}=$t(),j=ye(),qn=yh(),Mt=j.libvipsVersion(),te=j.format();te.heif.output.alias=["avif","heic"];te.jpeg.output.alias=["jpe","jpg"];te.tiff.output.alias=["tif"];te.jp2k.output.alias=["j2c","j2k","jp2","jpx"];var xh={nearest:"nearest",bilinear:"bilinear",bicubic:"bicubic",locallyBoundedBicubic:"lbb",nohalo:"nohalo",vertexSplitQuadraticBasisSpline:"vsqbs"},ge={vips:Mt.semver};if(!Mt.isGlobal)if(Mt.isWasm)try{ge=require("@img/sharp-wasm32/versions")}catch{}else try{ge=require(`@img/sharp-${qn}/versions`)}catch{try{ge=require(`@img/sharp-libvips-${qn}/versions`)}catch{}}ge.sharp=Pt().version;ge.heif&&te.heif&&(te.heif.input.fileSuffix=[".avif"],te.heif.output.alias=["avif"]);function Dn(e){return D.bool(e)?e?j.cache(50,20,100):j.cache(0,0,0):D.object(e)?j.cache(e.memory,e.files,e.items):j.cache()}Dn(!0);function _h(e){return j.concurrency(D.integer(e)?e:null)}Xe.familySync()===Xe.GLIBC&&!j._isUsingJemalloc()?j.concurrency(1):Xe.familySync()===Xe.MUSL&&j.concurrency()===1024&&j.concurrency(require("node:os").availableParallelism());var Ah=new vh.EventEmitter;function Ph(){return j.counters()}function Ch(e){return j.simd(D.bool(e)?e:null)}function $h(e){if(D.object(e))if(Array.isArray(e.operation)&&e.operation.every(D.string))j.block(e.operation,!0);else throw D.invalidParameterError("operation","Array<string>",e.operation);else throw D.invalidParameterError("options","object",e)}function Sh(e){if(D.object(e))if(Array.isArray(e.operation)&&e.operation.every(D.string))j.block(e.operation,!1);else throw D.invalidParameterError("operation","Array<string>",e.operation);else throw D.invalidParameterError("options","object",e)}Mn.exports=function(e){e.cache=Dn,e.concurrency=_h,e.counters=Ph,e.simd=Ch,e.format=te,e.interpolators=xh,e.versions=ge,e.queue=Ah,e.block=$h,e.unblock=Sh}});var Wn=E((Mc,Bn)=>{"use strict";var J=Gi();Ui()(J);Zi()(J);tn()(J);on()(J);On()(J);kn()(J);Fn()(J);Hn()(J);Bn.exports=J});var re=Ce(require("node:fs"));var dr=Ce(fr(),1),{program:Hh,createCommand:Bh,createArgument:Wh,createOption:Gh,CommanderError:Vh,InvalidArgumentError:zh,InvalidOptionArgumentError:Uh,Command:mr,Argument:Xh,Option:N,Help:Qh}=dr.default;var Vn=Ce(require("puppeteer")),zn=Ce(Wn());var Gn={name:"@helvio/web-screenshot",version:"2.0.4",description:"Screenshots Pages to PNG",keywords:["screenshot","webpage","png","image"],main:"dist/screenshot.js",bin:{"web-screenshot":"dist/screenshot.js"},scripts:{build:"npx esbuild --bundle --external:puppeteer src/screenshot.ts --minify --platform=node --outfile=dist/screenshot.js"},license:"ISC",preferGlobal:!0,author:"Helvio Pedreschi",bugs:"https://github.com/Helvio88/web-screenshot/issues",homepage:"https://github.com/Helvio88/web-screenshot",publishConfig:{access:"public"},dependencies:{commander:"^14.0.0",puppeteer:"^24.14.0",sharp:"^0.34.3",tslib:"^2.8.1"},devDependencies:{"@biomejs/biome":"^2.1.2",tsc:"^2.0.4",typescript:"^5.8.3"}};var Oh={sanitizeUrl(e){return e=e.trim(),!e.startsWith("http://")&&!e.startsWith("https://")&&(e=`http://${e}`),e},sanitizeTime(e){return Number.isInteger(e)&&e>=1&&e<=600?e*1e3:5e3},sanitizeX(e){return Number.isInteger(e)&&e>=0&&e<=1920?e:0},sanitizeY(e){return Number.isInteger(e)&&e>=0&&e<=1080?e:0},sanitizeWidth(e){return Number.isInteger(e)&&e>=1&&e<=1920?e:1920},sanitizeHeight(e){return Number.isInteger(e)&&e>=1&&e<=1080?e:1080},sanitizeOutput(e,t,r){let i=r,n="png";if(!i||/\.(png|jpg|jpeg|webp)$/i.test(i))if(i)n=i.split(".").pop().replace("jpg","jpeg"),i=i.substring(0,i.lastIndexOf("."));else{let s=e.split("/"),a=e.endsWith("/")?2:1;i=s[s.length-a]}return t&&(i=`${i}_tmp`),{path:i,ext:n}},sanitizeAuth(e){return/^[^:]+:[^:]+$/.test(e)?e:void 0}},$=Oh;var Un=new mr;Un.version(Gn.version).addHelpText("beforeAll","Web Screenshot Utility").addOption(new N("-p, --path [path]","Chrome executable path.")).addOption(new N("-d, --debug","Enable debug mode.").default(!1)).addOption(new N("-b, --batch [file]","Batch file with URLs to screenshot. Supersedes all other options.")).addOption(new N("-u, --url <url>","URL (website) to screenshot.")).addOption(new N("-t, --time [s]","Number of seconds to wait for page to load.").default(3)).addOption(new N("-x, --x [x]","Leftmost Pixel.").default(0)).addOption(new N("-y, --y [y]","Top Pixel.").default(0)).addOption(new N("-w, --width [width]","Image Width.").default(1920)).addOption(new N("-h, --height [height]","Image Height.").default(1080)).addOption(new N("-o, --out [out]","Absolute or Relative Path to save the screenshot.")).addOption(new N("-c, --crop","Auto crop same-color borders.")).addOption(new N("-a, --auth [auth]","NTLM Credentials in username:password format.")).parse(process.argv);var I=Un.opts(),Ht=[],M=I.debug||!1,Rh=I.path;if(I.batch){let e=I.batch;re.existsSync(e)||(console.error(`Batch file "${e}" does not exist.`),process.exit(1));let r=re.readFileSync(e,"utf-8").split(`
`).filter(i=>i.trim()!==""&&!i.startsWith("#"));for(let i of r){let n=i.split(" ").filter(A=>A.trim()!=="");M&&console.log("Parsed arguments:",n);let s=n.findIndex(A=>A.startsWith("-u")||A.startsWith("--url"));if(s===-1){M&&console.log("No URL found in line, skipping:",i);continue}let a=$.sanitizeUrl(n[s+1]),l=n.findIndex(A=>A.startsWith("-t")||A.startsWith("--time")),c=3;l!==-1&&(c=Number(n[l+1]));let f=$.sanitizeTime(c);M&&console.log(`Sanitized time: ${f}`);let m=n.findIndex(A=>A.startsWith("-x")||A.startsWith("--x")),d=0;m!==-1&&(d=Number(n[m+1]));let x=$.sanitizeX(d);M&&console.log(`Sanitized x: ${x}`);let U=n.findIndex(A=>A.startsWith("-y")||A.startsWith("--y")),H=0;U!==-1&&(H=Number(n[U+1]));let Bt=$.sanitizeY(H);M&&console.log(`Sanitized y: ${Bt}`);let Wt=n.findIndex(A=>A.startsWith("-w")||A.startsWith("--width")),Gt=1920;Wt!==-1&&(Gt=Number(n[Wt+1]));let Vt=$.sanitizeWidth(Gt);M&&console.log(`Sanitized width: ${Vt}`);let zt=n.findIndex(A=>A.startsWith("-h")||A.startsWith("--height")),Ut=1080;zt!==-1&&(Ut=Number(n[zt+1]));let Xt=$.sanitizeHeight(Ut);M&&console.log(`Sanitized height: ${Xt}`);let Qt=n.findIndex(A=>A.startsWith("-o")||A.startsWith("--out")),Qe;Qt!==-1&&(Qe=n[Qt+1]);let Pe=$.sanitizeOutput(a,!1,Qe),Jt=$.sanitizeOutput(a,!0,Qe),Xn=Pe.path,Qn=Jt.path,Jn=Pe.ext;M&&console.log(`Sanitized output path: ${Pe.path}, tmp: ${Jt.path}, ext: ${Pe.ext}`);let Kt=n.includes("--crop")||n.includes("-c");M&&console.log(`Crop flag: ${Kt}`);let Yt=n.findIndex(A=>A.startsWith("-a")||A.startsWith("--auth")),Je;Yt!==-1&&(Je=n[Yt+1]);let Zt=Je?$.sanitizeAuth(Je):void 0;M&&console.log(`Sanitized auth: ${Zt}`),Ht.push({url:a,time:f,x,y:Bt,width:Vt,height:Xt,path:Xn,tmp:Qn,ext:Jn,auth:Zt,crop:Kt})}}else I.url&&Ht.push({url:$.sanitizeUrl(I.url),time:$.sanitizeTime(I.time),x:$.sanitizeX(Number(I.x)),y:$.sanitizeY(Number(I.y)),width:$.sanitizeWidth(Number(I.width)),height:$.sanitizeHeight(Number(I.height)),path:$.sanitizeOutput(I.url,!1,I.out).path,tmp:$.sanitizeOutput(I.url,!0,I.out).path,ext:$.sanitizeOutput(I.url,!1,I.out).ext,auth:$.sanitizeAuth(I.auth),crop:I.crop||!1});(async()=>{try{let e=await Vn.launch({headless:M?!1:"shell",executablePath:Rh,args:["--no-sandbox"]});console.log("Browser Opened");let t=await e.newPage();console.log("Page Created"),await t.setViewport({width:1920,height:1080}),console.log("Viewport Set");for(let r of Ht)r.auth&&(await t.authenticate({username:r.auth.split(":")[0],password:r.auth.split(":")[1]}),console.log("Credentials Entered")),await t.goto(r.url),console.log(`Navigated to ${r.url}`),console.log(`Waiting for ${r.time/1e3} seconds`),await kh(r.time),console.log("Page Loaded"),await t.screenshot({clip:{x:r.x,y:r.y,width:r.width,height:r.height},path:`${r.tmp}.${r.ext}`}),console.log(`Temp screenshot taken: ${r.tmp}.${r.ext}`),r.crop?(await(0,zn.default)(`${r.tmp}.${r.ext}`).trim({threshold:0}).toFile(`${r.path}.${r.ext}`),re.unlinkSync(`${r.tmp}.${r.ext}`),console.log(`Image cropped and saved to ${r.path}.${r.ext}`)):(re.renameSync(`${r.tmp}.${r.ext}`,`${r.path}.${r.ext}`),console.log(`Image saved to ${r.path}.${r.ext}`));await t.close(),console.log("Page Closed"),await e.close(),console.log("Browser Closed"),console.log("Screenshot Process Completed Successfully"),process.exit(0)}catch(e){console.error("Screenshot Failed"),console.error(e),process.exit(1)}})();var kh=e=>new Promise(t=>setTimeout(t,e));
